<template>
  <div class="token-detail-page">
    <!-- Ëá™ÂÆö‰πâÂØºËà™Ê†è -->
    <div class="custom-header">
      <div class="header-content">
        <div class="header-left">
          <button @click="$router.go(-1)" class="back-btn">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round" />
            </svg>
          </button>
          <h1 class="header-title">RWAunion</h1>
        </div>

        <!-- ‰ª£Â∏ÅÂØºËà™Êéß‰ª∂ -->
        <div class="token-navigation">
          <button
            @click="navigateToPreviousToken"
            class="nav-btn prev-btn"
            :disabled="loading || currentTokenIndex <= 0"
            title="‰∏ä‰∏Ä‰∏™‰ª£Â∏Å"
          >
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>

          <span class="token-index-display">
            {{ currentTokenIndex + 1 }} / {{ totalTokenCount || '?' }}
          </span>

          <button
            @click="navigateToNextToken"
            class="nav-btn next-btn"
            :disabled="loading || currentTokenIndex >= (totalTokenCount - 1)"
            title="‰∏ã‰∏Ä‰∏™‰ª£Â∏Å"
          >
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- ‰∏ªË¶ÅÂÜÖÂÆπÂå∫Âüü -->
    <div class="main-content">
      <!-- Ê∑ªÂä†Âä†ËΩΩÁä∂ÊÄÅ -->
      <div v-if="loading" class="loading-overlay">
        <div class="loading-spinner"></div>
        <p>Âä†ËΩΩ‰∏≠...</p>
      </div>
      <!-- ËøîÂõûÊåâÈíÆ -->
      <div class="return-section">
        <button @click="$router.go(-1)" class="return-btn">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
            <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round" />
          </svg>
          Return
        </button>
      </div>

      <!-- About CHOU Ê†áÈ¢ò -->
      <div class="page-title">
        <h2>About CHOU</h2>
      </div>

      <!-- ‰ª£Â∏Å‰ø°ÊÅØÂç°Áâá -->
      <div class="token-info-card">
        <div class="token-header">
          <div class="token-avatar">
            <div class="token-icon-wrapper">
              üê∏
            </div>
          </div>
          <div class="token-details">
            <h3 class="token-name">{{ tokenInfo.name }}</h3>
            <p class="token-symbol">${{ tokenInfo.symbol }}</p>
            <div class="contract-address">
              <span class="address-text">{{ formatAddress(tokenInfo.contractAddress) }}</span>
              <button @click="copyAddress(tokenInfo.contractAddress)" class="copy-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"
                    stroke="currentColor" stroke-width="2" />
                  <rect x="8" y="2" width="8" height="4" rx="1" ry="1" stroke="currentColor" stroke-width="2" />
                </svg>
              </button>
              <button @click="openInExplorer(tokenInfo.contractAddress)" class="external-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                  <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" stroke="currentColor"
                    stroke-width="2" />
                  <polyline points="15,3 21,3 21,9" stroke="currentColor" stroke-width="2" />
                  <line x1="10" y1="14" x2="21" y2="3" stroke="currentColor" stroke-width="2" />
                </svg>
              </button>
            </div>
          </div>
        </div>

        <!-- ‰ª£Â∏ÅÊèèËø∞ -->
        <div class="token-description">
          <p>{{ tokenInfo.description }}</p>
        </div>

        <!-- Á§æ‰∫§Â™í‰ΩìÊåâÈíÆ -->
        <div class="social-actions">
          <button class="social-btn twitter-btn" @click="openTwitter">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path
                d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z" />
            </svg>
          </button>
          <button class="social-btn telegram-btn" @click="openTelegram">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path
                d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z" />
            </svg>
          </button>
          <button class="social-btn website-btn" @click="openWebsite">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10" />
              <line x1="2" y1="12" x2="22" y2="12" />
              <path d="m12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z" />
            </svg>
          </button>
        </div>
      </div>

      <!-- Êìç‰ΩúÊåâÈíÆÁªÑ -->
      <div class="action-buttons">
        <button v-for="(btn, index) in actionButtons" :key="index"
          :class="['action-btn', { active: activeButton === index }]" @click="setActiveButton(index)">
          {{ btn }}
        </button>
      </div>

      <!-- ‰ø°ÊÅØÂå∫ÂüüÂÜÖÂÆπ -->
      <div v-if="activeButton === 0" class="info-content">
        <!-- ‰ª£Â∏ÅÂü∫Êú¨‰ø°ÊÅØË°®Ê†º -->
        <div class="info-section-card">
          <div class="token-info-table">
            <div class="info-row">
              <div class="info-label">Token name</div>
              <div class="info-value">{{ tokenInfo.tokenName }}</div>
            </div>
            <div class="info-row">
              <div class="info-label">Name(Symbol)</div>
              <div class="info-value">{{ tokenInfo.nameSymbol }}</div>
            </div>
            <div class="info-row">
              <div class="info-label">Supply</div>
              <div class="info-value">{{ tokenInfo.supply }}</div>
            </div>
            <div class="info-row">
              <div class="info-label">Tokenomic preset</div>
              <div class="info-value">{{ tokenInfo.tokenomicPreset }}</div>
            </div>
          </div>

          <!-- ÂÖçË¥£Â£∞Êòé -->
          <div class="disclaimer-section">
            <div class="disclaimer-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z" />
                <line x1="12" y1="9" x2="12" y2="13" />
                <line x1="12" y1="17" x2="12.01" y2="17" />
              </svg>
            </div>
            <div class="disclaimer-text">
              <p><strong>Disclaimer:</strong> The listed tokens have nothing to do with TRX, please use at your own risk
              </p>
            </div>
          </div>
        </div>

        <!-- Token for LGE ËØ¶ÊÉÖ -->
        <div class="info-section-card">
          <h3 class="section-title">Token for LGE</h3>
          <div class="lge-info-table">
            <div class="info-row">
              <div class="info-label">Token for LGE</div>
              <div class="info-value">{{ tokenInfo.tokenForLGE }}</div>
            </div>
            <div class="info-row">
              <div class="info-label">TST/TRX rate</div>
              <div class="info-value">{{ tokenInfo.tstTrxRate }}</div>
            </div>
            <!-- ‰øÆÊîπ‰∏∫ -->
            <div class="info-row">
              <div class="info-label">Soft cap</div>
              <div class="info-value">{{ tokenInfo.softCap }}</div>
            </div>
            <div class="info-row">
              <div class="info-label">Hard cap</div>
              <div class="info-value">{{ tokenInfo.hardCap }}</div>
            </div>
            <div class="info-row">
              <div class="info-label">Max buy</div>
              <div class="info-value">{{ tokenInfo.maxBuy }}</div>
            </div>
            <div class="info-row">
              <div class="info-label">Start time</div>
              <div class="info-value">{{ tokenInfo.startTime }}</div>
            </div>
            <div class="info-row">
              <div class="info-label">End time</div>
              <div class="info-value">{{ tokenInfo.endTime }}</div>
            </div>
            <div class="info-row">
              <div class="info-label">Duration</div>
              <div class="info-value">{{ tokenInfo.duration }}</div>
            </div>
            <div class="info-row">
              <div class="info-label">Vesting delay</div>
              <div class="info-value">{{ tokenInfo.vestingDelay }}</div>
            </div>
            <div class="info-row">
              <div class="info-label">Vesting rate(%)</div>
              <div class="info-value">{{ tokenInfo.vestingRate }}</div>
            </div>
            <div class="info-row">
              <div class="info-label">Vesting rounds</div>
              <div class="info-value">{{ tokenInfo.vestingRounds }}</div>
            </div>
            <div class="info-row">
              <div class="info-label">TRX pair</div>
              <div class="info-value">{{ tokenInfo.trxPair }}</div>
            </div>
            <div class="info-row">
              <div class="info-label">Backing</div>
              <div class="info-value">{{ tokenInfo.backing }}</div>
            </div>
          </div>
        </div>

        <!-- ÁªëÂÆöÊõ≤Á∫øÁôæÂàÜÊØî -->
        <div class="info-section-card bonding-curve-card">
          <div class="bonding-curve-header">
            <div class="curve-title">Binding Curve Percentage</div>
            <div class="percentage-badge">
              {{ fundingPercentage.toFixed(2) }}%
            </div>
          </div>

          <div class="enhanced-progress-container">
            <div class="progress-track">
              <div
                class="progress-fill"
                :style="{ width: fundingPercentage + '%' }"
              ></div>
              <div
                class="progress-thumb"
                :style="{ left: fundingPercentage + '%' }"
              ></div>
            </div>
            <div class="progress-labels">
              <span class="progress-start">0%</span>
              <span class="progress-end">100%</span>
            </div>
          </div>

          <div class="curve-status-info">
            <div class="status-text">
              When the progress reaches 100%, the casting will end
            </div>
            <div class="funding-stats">
              <div class="stat-item">
                <span class="stat-label">Current</span>
                <span class="stat-value">{{ fundingPercentage.toFixed(1) }}%</span>
              </div>
              <div class="stat-item">
                <span class="stat-label">Target</span>
                <span class="stat-value">100%</span>
              </div>
            </div>
          </div>

          <!-- ÂèÇ‰∏éÈ¢ÑÂîÆÂå∫Âüü -->
          <div class="presale-participation-section">
            <div class="presale-section-title">Enter presale</div>

            <div class="presale-input-container">
              <div class="amount-input-wrapper">
                <input
                  v-model="presaleAmount"
                  type="number"
                  placeholder="Input quantity"
                  class="presale-amount-input"
                  :disabled="presaleLoading || !isWalletConnected"
                  @input="validatePresaleAmount"
                />
                <button
                  class="max-button"
                  @click="setMaxAmount"
                  :disabled="presaleLoading || !isWalletConnected"
                >
                  MAX
                </button>
              </div>

              <div class="balance-display">
                TRX balance: {{ formatBalance(userTrxBalance) }}
              </div>

              <div v-if="presaleValidationError" class="validation-error">
                {{ presaleValidationError }}
              </div>

              <button
                class="enter-presale-button"
                @click="enterPresale"
                :disabled="!canEnterPresale"
                :class="{
                  'loading': presaleLoading,
                  'success': presaleSuccess
                }"
              >
                <span v-if="presaleLoading" class="loading-spinner"></span>
                <span v-else-if="presaleSuccess">‚úì Success</span>
                <span v-else>Enter presale</span>
              </button>
            </div>
          </div>
        </div>



        <!-- ÂÜÖÁõòÊä¢Ë¥≠Âå∫Âüü -->
        <div class="info-section-card">
          <div class="internal-market-title">RWAUnion ÂÜÖÁõòÊä¢Ë¥≠</div>
          <div class="internal-market-desc">
            ÁôΩÂêçÂçïÁî®Êà∑ÂèØÂú®Â§ñÈÉ®Â∏ÇÂú∫ÂºÄÊîæÂâç‰∏ÄÂ∞èÊó∂Âú®ÂÜÖÁõòÈ¢ÑË¥≠
          </div>

          <div class="quantity-selector">
            <button @click="decreaseInternalAmount" class="quantity-btn">-</button>
            <span class="quantity-display">{{ internalMarketAmount }} TRX</span>
            <button @click="increaseInternalAmount" class="quantity-btn">+</button>
          </div>

          <div class="balance-info">
            TRX balance: {{ formatNumber(trxBalance) }}
          </div>

          <div class="quota-info">
            <span class="quota-label">ÂÜÖÁõòÈ¢ùÂ∫¶:</span>
            <span class="quota-value">{{ internalMarketQuota }}‰ªΩ</span>
          </div>

          <button @click="buyInternalMarket" class="buy-now-btn">
            BUY NOW
          </button>

          <div class="real-time-price">
            {{ realTimePrice }}
          </div>
        </div>
      </div>

      <!-- È¢ÑÂîÆÂÜÖÂÆπÂå∫Âüü -->
      <div v-if="activeButton === 1" class="presale-content">

        <!-- ÊµÅÂä®ÊÄßÊ±†ËØ¶ÊÉÖ -->
        <div class="lp-details-section">
          <div class="lp-item">
            <span class="lp-label">ÊÄªÈîÅÂÆöLP</span>
            <span class="lp-value">{{ formatNumber(lpData.totalLocked) }}</span>
          </div>

          <div class="lp-item">
            <span class="lp-label">Êú™Ëß£ÈîÅLP (60%)</span>
            <span class="lp-value">{{ formatNumber(lpData.unlocked) }}</span>
            <div class="lp-sub-info">({{ formatNumber(lpData.unlockedTrx) }} TRX + {{ formatNumber(lpData.unlockedToken)
            }} {{ tokenInfo.symbol }})</div>
          </div>

          <div class="lp-item">
            <span class="lp-label">Â∑≤È¢ÜÂèñLP (20%)</span>
            <span class="lp-value">{{ formatNumber(lpData.claimed) }}</span>
          </div>

          <div class="lp-item">
            <span class="lp-label">ÂèØÈ¢ÜÂèñLP (20%)</span>
            <span class="lp-value">{{ formatNumber(lpData.claimable) }}</span>
          </div>

          <div class="lp-item">
            <span class="lp-label">Â∞ÜËé∑Âæó</span>
            <span class="lp-value">{{ countdownData.timeLeft }}</span>
            <div class="lp-sub-info">({{ formatNumber(lpData.willReceive) }} USDT)</div>
          </div>

          <div class="lp-item">
            <span class="lp-label">‰∏ãÊ¨°Ëß£ÈîÅÊó∂Èó¥</span>
            <span class="lp-value">{{ countdownData.nextUnlock }}</span>
          </div>

          <button @click="claimLp" class="receive-button">
            Receive
          </button>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import TokenService from '../tron/services/TokenService';
import PresaleService from '../tron/services/PresaleService';
import coordinatorFactoryService from '../tron/services/CoordinatorFactoryService';
import { AddressUtils } from '../tron/config';
import presaleABI from '../../contract/presaleABI.json';

export default {
  name: 'TokenDetailPage',
  props: {
    id: {
      type: String,
      default: null
    }
  },
  data() {
    return {
      loading: false,
      error: null,
      activeButton: 0,
      actionButtons: ['‰ø°ÊÅØ', 'È¢ÑÂîÆ', 'ÂÜÖÁõò'],

      // ‰ª£Â∏Å‰ø°ÊÅØ
      tokenInfo: {
        name: 'CHOU',
        symbol: 'CHO',
        contractAddress: 'TE8EDTFy7CD2TXyrb7wCCHNaC8rao9HEiC',
        description: 'PEPE visits all northern countries and regions in 2025 - Alaska, Canada, Greenland, Iceland, Norway, Sweden, Finland and Siberia. He is not scare from the cold and polar bears. PEPE enjoys the beautiful north nature and the northern lights.',

        // Âü∫Êú¨‰ø°ÊÅØ
        tokenName: 'CHO',
        nameSymbol: 'CHO',
        supply: '210000000',
        tokenomicPreset: '0.5%/0.5%',

        // LGEÁõ∏ÂÖ≥ÂèÇÊï∞
        tokenForLGE: '100%',
        tstTrxRate: '1 TST=1 TRX',
        softCap: '333 TRX',  // Á°¨È°∂ÁöÑ1/3
        hardCap: '1000 TRX',
        minBuy: '500 TRX',
        maxBuy: '500 TRX',
        startTime: '2025/08/15 14:14(4d 2h)',
        endTime: '2025/08/15 14:14(4d 2h)',
        duration: '90 days',
        vestingDelay: '10 days',
        vestingRate: '10%',
        vestingRounds: '5 rounds',
        trxPair: '25% TRX / 50% union',
        backing: '25% TRX / 50% union'
      },

      // ‰ª£Â∏ÅÂØºËà™Áõ∏ÂÖ≥
      totalTokenCount: 0,
      currentTokenIndex: 0, // ÂΩìÂâç‰ª£Â∏ÅÁ¥¢ÂºïÁöÑÊú¨Âú∞Áä∂ÊÄÅ

      // ËµÑÈáëÊõ≤Á∫øÊï∞ÊçÆ
      fundingPercentage: 30.89,

      // È¢ÑÂîÆÁõ∏ÂÖ≥Êï∞ÊçÆ
      presaleInputAmount: '',
      trxBalance: 1648523,
      internalMarketQuota: 3,
      realTimePrice: '1 TRX ‚âà 651 RWAUnion',
      internalMarketAmount: 100,

      // ÁªëÂÆöÊõ≤Á∫øÈ¢ÑÂîÆÂèÇ‰∏éÊï∞ÊçÆ
      presaleAmount: '',
      userTrxBalance: 1648523,
      presaleLoading: false,
      presaleSuccess: false,
      presaleValidationError: '',
      presaleContractAddress: null,
      presaleAddressToken: null, // ÁºìÂ≠òÁöÑÈ¢ÑÂîÆÂú∞ÂùÄÂØπÂ∫îÁöÑ‰ª£Â∏ÅÂú∞ÂùÄ
      walletWatcher: null,
      indexChangeTimeout: null, // Èò≤ÊäñÂÆöÊó∂Âô®

      // ‰π∞ÂçñÁõ∏ÂÖ≥Êï∞ÊçÆ
      buySellTab: 'buy',
      inputAmount: '',

      // LPÊï∞ÊçÆ
      lpData: {
        totalLocked: 165416165165165,
        unlocked: 515165165,
        unlockedTrx: 500,
        unlockedToken: 4012165165.551,
        claimed: 5615011,
        claimable: 548651,
        willReceive: 19.6606
      },

      // ÂÄíËÆ°Êó∂Êï∞ÊçÆ
      countdownData: {
        timeLeft: '13D 14H 23M',
        nextUnlock: '12D 12H 18M 30S'
      }
    }
  },

  computed: {
    // Èí±ÂåÖËøûÊé•Áä∂ÊÄÅ
    isWalletConnected() {
      return this.$tronState?.isConnected || false;
    },

    // ÊòØÂê¶ÂèØ‰ª•ÂèÇ‰∏éÈ¢ÑÂîÆ
    canEnterPresale() {
      return (
        this.isWalletConnected &&
        !this.presaleLoading &&
        this.presaleAmount &&
        !this.presaleValidationError &&
        parseFloat(this.presaleAmount) > 0
      );
    },

    // ÊúÄÂ§ßÂèØÊäïÂÖ•ÈáëÈ¢ù
    maxPresaleAmount() {
      const balance = this.userTrxBalance || 0;
      const hardCap = parseFloat(this.tokenInfo.hardCap?.replace(/[^\d.]/g, '') || '1000');
      const currentRaised = (this.fundingPercentage / 100) * hardCap;
      const remaining = hardCap - currentRaised;

      return Math.min(balance, remaining);
    }
  },

  mounted() {
    // ÂÖàÊää URL ÁöÑ search Âíå hash ÂèÇÊï∞ËßÑËåÉÂåñÂêåÊ≠•Âà∞ $route ‰∏ä
    this.syncUrlParamsToRouter();
    
    // Ê∑ªÂä†Ë∞ÉËØïÔºöÊ£ÄÊü• tokenInfo ÁöÑÂàùÂßãÁä∂ÊÄÅ
    console.log('üîç È°µÈù¢Âä†ËΩΩÊó∂ tokenInfo Áä∂ÊÄÅ:', {
      tokenForLGE: this.tokenInfo.tokenForLGE,
      hardCap: this.tokenInfo.hardCap,
      maxBuy: this.tokenInfo.maxBuy,
      ÂÆåÊï¥ÂØπË±°: this.tokenInfo
    });

    this.initializeData();
    this.updateCountdown();

    // ÁõëÂê¨Èí±ÂåÖËøûÊé•Áä∂ÊÄÅÂèòÂåñ
    this.watchWalletConnection();

    // Ê≥®ÂÜåÂÖ®Â±ÄÈ¢ÑÂîÆÁÆ°ÁêÜÊñπÊ≥ïÂà∞ÊéßÂà∂Âè∞
    this.registerConsoleCommands();
  },

  beforeDestroy() {
    // Ê∏ÖÁêÜÂÖ®Â±ÄÊñπÊ≥ï
    this.unregisterConsoleCommands();
  },

  watch: {
    // ÁõëÂê¨ tokenForLGE ÁöÑÂèòÂåñ
    'tokenInfo.tokenForLGE': {
      handler(newVal, oldVal) {
        console.log('üîç tokenForLGE ÂèëÁîüÂèòÂåñ:', {
          ÊóßÂÄº: oldVal,
          Êñ∞ÂÄº: newVal,
          ÂèòÂåñÊó∂Èó¥: new Date().toLocaleString()
        });
      },
      immediate: true
    },

    // ÁõëÂê¨Ë∑ØÁî±Êü•ËØ¢ÂèÇÊï∞ÂèòÂåñ
    '$route.query.index': {
      handler(newIndex, oldIndex) {
        if (newIndex !== oldIndex && newIndex !== undefined) {
          const targetIndex = parseInt(newIndex);
          console.log(`üîÑ Ë∑ØÁî±Á¥¢ÂºïÂèòÂåñ: ${oldIndex} ‚Üí ${newIndex}`);

          // Èò≤ÊäñÂ§ÑÁêÜÔºåÈÅøÂÖçÈáçÂ§çÂä†ËΩΩ
          if (this.indexChangeTimeout) {
            clearTimeout(this.indexChangeTimeout);
          }

          this.indexChangeTimeout = setTimeout(async () => {
            // Âè™ÊúâÂΩìÊñ∞Á¥¢Âºï‰∏éÂΩìÂâçÊú¨Âú∞Áä∂ÊÄÅ‰∏çÂêåÊó∂ÊâçÊõ¥Êñ∞
            if (targetIndex !== this.currentTokenIndex) {
              console.log(`üìä ÂºÄÂßãÂä†ËΩΩÁ¥¢Âºï ${targetIndex} ÁöÑ‰ª£Â∏Å...`);
              try {
                await this.loadTokenByIndex(targetIndex);
                console.log(`‚úÖ Á¥¢Âºï ${targetIndex} Âä†ËΩΩÂÆåÊàê`);
              } catch (error) {
                console.error(`‚ùå Á¥¢Âºï ${targetIndex} Âä†ËΩΩÂ§±Ë¥•:`, error);
                this.$toast(`Âä†ËΩΩ‰ª£Â∏ÅÂ§±Ë¥•ÔºåËØ∑ÈáçËØï`);
              }
            }
          }, 100); // 100msÈò≤ÊäñÂª∂Ëøü
        }
      },
      immediate: true // ‚úÖ ‰øÆÂ§çÔºöËÆæÁΩÆ‰∏∫trueÔºåÁ°Æ‰øùÈ°µÈù¢ÂàùÂßãÂåñÊó∂Á´ãÂç≥ÂìçÂ∫îURLÂèÇÊï∞
    }
  },

  beforeUnmount() {
    // Ê∏ÖÁêÜÂÆöÊó∂Âô®
    if (this.walletWatcher) {
      clearInterval(this.walletWatcher);
    }
    // Ê∏ÖÁêÜÈò≤ÊäñÂÆöÊó∂Âô®
    if (this.indexChangeTimeout) {
      clearTimeout(this.indexChangeTimeout);
    }
  },

  methods: {
    async initializeData() {
      this.loading = true;
      try {
        // 1. Âä†ËΩΩ‰ª£Â∏ÅËØ¶ÊÉÖ
        await this.loadTokenDetails();

        // 2. Âä†ËΩΩÈ¢ÑÂîÆ‰ø°ÊÅØ
        await this.loadPresaleInfo();

        // 3. Âä†ËΩΩÁî®Êà∑‰ΩôÈ¢ù
        await this.loadUserBalance();

      } catch (error) {
        console.error('Failed to initialize data:', error);
        this.$toast('Êï∞ÊçÆÂä†ËΩΩÂ§±Ë¥•');
      } finally {
        this.loading = false;
      }
    },

    async loadTokenDetails() {
      const params = this.getUrlParams();
      console.log('üîç Loading token details with params:', params);

      // Â¶ÇÊûúÊúâtokenAddressÔºåÁõ¥Êé•‰ΩøÁî®
      if (params.tokenAddress && this.validateAddress(params.tokenAddress)) {
        console.log('üìç ‰ΩøÁî®ÊåáÂÆöÁöÑ‰ª£Â∏ÅÂú∞ÂùÄ:', params.tokenAddress);
        // ÈáçÁΩÆÁ¥¢ÂºïÁä∂ÊÄÅÔºåÂõ†‰∏∫‰ΩøÁî®ÁöÑÊòØÂú∞ÂùÄËÄå‰∏çÊòØÁ¥¢Âºï
        this.currentTokenIndex = 0;
        await this.loadTokenByAddress(params.tokenAddress);
      }
      // Â¶ÇÊûúÊúâtokenIdÔºåÈÄöËøáIDËé∑Âèñ
      else if (params.tokenId) {
        console.log('üÜî ‰ΩøÁî®ÊåáÂÆöÁöÑ‰ª£Â∏ÅID:', params.tokenId);
        // ÈáçÁΩÆÁ¥¢ÂºïÁä∂ÊÄÅÔºåÂõ†‰∏∫‰ΩøÁî®ÁöÑÊòØIDËÄå‰∏çÊòØÁ¥¢Âºï
        this.currentTokenIndex = 0;
        await this.loadTokenById(params.tokenId);
      }
      // Â¶ÇÊûúÊúâindexÂèÇÊï∞ÔºåÂä†ËΩΩÊåáÂÆöÁ¥¢ÂºïÁöÑ‰ª£Â∏Å
      else if (params.index !== undefined) {
        const targetIndex = parseInt(params.index);
        console.log('üìä ‰ΩøÁî®ÊåáÂÆöÁöÑ‰ª£Â∏ÅÁ¥¢Âºï:', targetIndex);

        // ‚úÖ ‰ºòÂåñÔºöÊ£ÄÊü•ÊòØÂê¶Â∑≤ÁªèÊòØÁõÆÊ†áÁ¥¢ÂºïÔºåÈÅøÂÖçÈáçÂ§çÂä†ËΩΩ
        if (this.currentTokenIndex !== targetIndex) {
          console.log(`üîÑ Á¥¢ÂºïÂèòÂåñ: ${this.currentTokenIndex} ‚Üí ${targetIndex}`);
          await this.loadTokenByIndex(targetIndex);
        } else {
          console.log(`üìä Á¥¢ÂºïÊú™ÂèòÂåñÔºåË∑≥ËøáÂä†ËΩΩ: ${targetIndex}`);
        }
      }
      // ÈªòËÆ§Âä†ËΩΩÁ¨¨0‰∏™‰ª£Â∏Å
      else {
        console.log('üîÑ ‰ΩøÁî®ÈªòËÆ§‰ª£Â∏ÅÔºàÁ¥¢Âºï0Ôºâ');
        // ËÆæÁΩÆÈªòËÆ§Á¥¢ÂºïÁä∂ÊÄÅ
        this.currentTokenIndex = 0;
        await this.loadTokenByIndex(0);
      }
    },
    // ÈÄöËøáÂú∞ÂùÄÂä†ËΩΩ‰ª£Â∏ÅÔºà‰ªéÈìæ‰∏äËØªÂèñToken‰ø°ÊÅØ‰∏éÊâãÁª≠Ë¥πÈÖçÁΩÆÔºâ
    async loadTokenByAddress(tokenAddress) {
      try {
        const base58Address = AddressUtils.toBase58(tokenAddress)
        const tokenService = new TokenService(base58Address)

        const [info, baseCfg] = await Promise.all([
          tokenService.getTokenInfo(),
          tokenService.callMethod('baseConfig').catch(() => null)
        ])

        const decimals = parseInt(info.decimals)
        const supplyFormatted = TokenService.formatTokenAmount(
          info.totalSupply.toString(),
          isNaN(decimals) ? 18 : decimals
        )

        // Ê∑ªÂä†Ë∞ÉËØïÊó•Âøó
        console.log(`üìä Á¨¨‰∏É‰∏™‰ª£Â∏ÅtotalSupplyÂ§ÑÁêÜ:`, {
          raw: info.totalSupply.toString(),
          decimals: isNaN(decimals) ? 18 : decimals,
          formatted: supplyFormatted
        })

        let feeBuy = 0, feeSell = 0
        if (baseCfg) {
          feeBuy = Number(baseCfg.feeBuy || baseCfg[0] || 0)
          feeSell = Number(baseCfg.feeSell || baseCfg[1] || 0)
        }
        const tokenomicPreset = `${(feeBuy / 100).toFixed(2)}%/${(feeSell / 100).toFixed(2)}%`

        this.tokenInfo = {
          ...this.tokenInfo,
          name: info.name,
          symbol: info.symbol,
          contractAddress: base58Address,
          tokenName: info.name,
          nameSymbol: `${info.name} (${info.symbol})`,
          supply: supplyFormatted,
          tokenomicPreset
        }
      } catch (error) {
        console.error('Failed to load token by address:', error)
        this.$toast('‰ª£Â∏Å‰ø°ÊÅØÂä†ËΩΩÂ§±Ë¥•')
      }
    },

    // ÈÄöËøáIDÂä†ËΩΩ‰ª£Â∏Å
    async loadTokenById(tokenId) {
      console.log('üÜî Loading token by ID:', tokenId);
      // ÊöÇÊó∂‰ΩøÁî®ÈªòËÆ§Êï∞ÊçÆÔºàÁ¥¢Âºï0Ôºâ
      await this.loadTokenByIndex(0);
    },

    // Âä†ËΩΩÈªòËÆ§‰ª£Â∏ÅÔºö‰ªéÂ∑•ÂéÇÂêàÁ∫¶Âä®ÊÄÅËé∑Âèñ‰∏Ä‰∏™Á§∫‰æã‰ª£Â∏Å
    async loadDefaultToken() {
      console.log('Loading default token from factory')
      await this.loadTokenFromFactoryExample()
    },

    // ‰ªéÂ∑•ÂéÇÂêàÁ∫¶Ëé∑Âèñ‰∏Ä‰∏™‰ª£Â∏ÅÁ§∫‰æãÂπ∂Âä†ËΩΩÂÖ∂ËØ¶ÊÉÖ
    async loadTokenFromFactoryExample() {
      try {
        console.log('üîç ‰ªéÂ∑•ÂéÇÂêàÁ∫¶Ëé∑Âèñ‰ª£Â∏ÅÁ§∫‰æã...')

        // ‰ΩøÁî®Êñ∞ÁöÑÊô∫ËÉΩËé∑ÂèñÊñπÊ≥ïÔºåÁ°Æ‰øùËÉΩËé∑ÂèñÂà∞ÂèØÁî®ÁöÑ‰ª£Â∏Å
        const result = await coordinatorFactoryService.getAllTokenPresalePairsComplete()

        if (!result.pairs || result.pairs.length === 0) {
          console.warn('‚ö†Ô∏è Â∑•ÂéÇÂêàÁ∫¶‰∏≠Ê≤°ÊúâÊâæÂà∞‰ªª‰Ωï‰ª£Â∏ÅÂØπ')
          this.$toast('Â∑•ÂéÇÂêàÁ∫¶‰∏≠ÊöÇÊó†ÂèØÁî®‰ª£Â∏Å')
          return
        }

        console.log(`‚úÖ ÊâæÂà∞${result.pairs.length}‰∏™‰ª£Â∏ÅÂØπÔºå‰ΩøÁî®Á¨¨7‰∏™‰Ωú‰∏∫Á§∫‰æã`)

        const pair = result.pairs[7]
        const tokenAddress = AddressUtils.toBase58(pair.tokenAddress || pair[7])
        await this.loadTokenByAddress(tokenAddress)

      } catch (error) {
        console.error('‚ùå ‰ªéÂ∑•ÂéÇÂêàÁ∫¶Ëé∑Âèñ‰ª£Â∏ÅÁ§∫‰æãÂ§±Ë¥•:', error)
        this.$toast('‰ªéÂ∑•ÂéÇÂêàÁ∫¶Ëé∑Âèñ‰ª£Â∏ÅÂ§±Ë¥•')
      }
    },

    /**
     * ÈÄöËøáÁ¥¢ÂºïÂä†ËΩΩ‰ª£Â∏Å
     * @param {number} index - ‰ª£Â∏ÅÁ¥¢ÂºïÔºà0ÂºÄÂßãÔºâ
     */
    async loadTokenByIndex(index) {
      try {
        console.log(`üîç Âä†ËΩΩÁ¥¢Âºï‰∏∫ ${index} ÁöÑ‰ª£Â∏Å...`);

        // Ëé∑ÂèñÊâÄÊúâ‰ª£Â∏ÅÂØπ
        const result = await coordinatorFactoryService.getAllTokenPresalePairsComplete();

        if (!result.pairs || result.pairs.length === 0) {
          console.warn('‚ö†Ô∏è Â∑•ÂéÇÂêàÁ∫¶‰∏≠Ê≤°ÊúâÊâæÂà∞‰ªª‰Ωï‰ª£Â∏ÅÂØπ');
          this.$toast('Â∑•ÂéÇÂêàÁ∫¶‰∏≠ÊöÇÊó†ÂèØÁî®‰ª£Â∏Å');
          return;
        }

        console.log(`üìä ÊÄªÂÖ±ÊâæÂà∞ ${result.pairs.length} ‰∏™‰ª£Â∏ÅÂØπ`);

        // Êõ¥Êñ∞ÊÄª‰ª£Â∏ÅÊï∞Èáè
        this.totalTokenCount = result.pairs.length;

        // È™åËØÅÁ¥¢ÂºïËåÉÂõ¥
        if (index < 0) {
          console.warn(`‚ö†Ô∏è Á¥¢Âºï‰∏çËÉΩ‰∏∫Ë¥üÊï∞: ${index}Ôºå‰ΩøÁî®Á¥¢Âºï 0`);
          index = 0;
        } else if (index >= result.pairs.length) {
          console.warn(`‚ö†Ô∏è Á¥¢Âºï ${index} Ë∂ÖÂá∫ËåÉÂõ¥ (0-${result.pairs.length - 1})Ôºå‰ΩøÁî®ÊúÄÂêé‰∏Ä‰∏™‰ª£Â∏Å`);
          index = result.pairs.length - 1;
          this.$toast(`ÊåáÂÆöÁöÑÁ¥¢ÂºïË∂ÖÂá∫ËåÉÂõ¥ÔºåÊòæÁ§∫ÊúÄÂêé‰∏Ä‰∏™‰ª£Â∏ÅÔºàÁ¥¢Âºï ${index}Ôºâ`);
        }

        const pair = result.pairs[index];
        const tokenAddress = AddressUtils.toBase58(pair.tokenAddress || pair[7]);

        console.log(`‚úÖ Âä†ËΩΩÁ¥¢Âºï ${index} ÁöÑ‰ª£Â∏Å:`, {
          tokenSymbol: pair.tokenSymbol,
          tokenName: pair.tokenName,
          tokenAddress: tokenAddress
        });

        // Êõ¥Êñ∞Êú¨Âú∞Áä∂ÊÄÅ
        this.currentTokenIndex = index;

        // Âú®URL‰∏≠Êõ¥Êñ∞ÂΩìÂâçÁ¥¢ÂºïÔºà‰∏çÂà∑Êñ∞È°µÈù¢Ôºâ
        this.updateUrlWithIndex(index);

        await this.loadTokenByAddress(tokenAddress);

        // ÂàáÊç¢‰ª£Â∏ÅÂêéÈáçÁΩÆÂπ∂ÈáçÊñ∞Ëé∑ÂèñÈ¢ÑÂîÆ‰ø°ÊÅØÔºåÁ°Æ‰øùÊéßÂà∂Âè∞‰∏éÊåâÈíÆÊåáÂêëÊ≠£Á°ÆÁöÑÂêàÁ∫¶
        this.presaleContractAddress = null;
        this.presaleAddressToken = null;
        try {
          await this.loadPresaleInfo();
          await this.updateFundingProgress();
          console.log('üîÅ Â∑≤Ê†πÊçÆÊñ∞‰ª£Â∏ÅÂà∑Êñ∞È¢ÑÂîÆ‰ø°ÊÅØ‰∏éËøõÂ∫¶');
        } catch (e) {
          console.warn('‚ö†Ô∏è Âà∑Êñ∞È¢ÑÂîÆ‰ø°ÊÅØÂ§±Ë¥•:', e?.message || e);
        }

      } catch (error) {
        console.error('‚ùå ÈÄöËøáÁ¥¢ÂºïÂä†ËΩΩ‰ª£Â∏ÅÂ§±Ë¥•:', error);
        this.$toast(`Âä†ËΩΩÁ¥¢Âºï ${index} ÁöÑ‰ª£Â∏ÅÂ§±Ë¥•`);

        // ÂõûÈÄÄÂà∞ÈªòËÆ§‰ª£Â∏Å
        if (index !== 0) {
          console.log('üîÑ ÂõûÈÄÄÂà∞ÈªòËÆ§‰ª£Â∏ÅÔºàÁ¥¢Âºï 0Ôºâ');
          await this.loadTokenByIndex(0);
        }
      }
    },

    /**
     * Êõ¥Êñ∞URL‰∏≠ÁöÑÁ¥¢ÂºïÂèÇÊï∞Ôºà‰∏çÂà∑Êñ∞È°µÈù¢Ôºâ
     * @param {number} index - ‰ª£Â∏ÅÁ¥¢Âºï
     */
    updateUrlWithIndex(index) {
      try {
        // ‰ΩøÁî® Vue Router Êõ¥Êñ∞ÂìàÂ∏åË∑ØÁî±ÁöÑ queryÔºåÁ°Æ‰øù $route.query ËÉΩËØªÂèñ
        const current = this.$route;
        const newQuery = { ...current.query, index: index.toString() };

        // ‰øùÁïôÁé∞ÊúâÁöÑ paramsÔºàÂ¶Ç :idÔºâÔºåÂè™Êõ¥Êñ∞ query
        this.$router.replace({
          name: current.name || 'tokenDetail',
          params: current.params,
          query: newQuery
        }).catch(() => {});

        console.log('üìç Router query Â∑≤Êõ¥Êñ∞', {
          fullPath: this.$route.fullPath,
          query: this.$route.query
        });
      } catch (error) {
        console.warn('‚ö†Ô∏è Êõ¥Êñ∞Ë∑ØÁî± query Â§±Ë¥•:', error);
      }
    },

    // Âä†ËΩΩÈ¢ÑÂîÆ‰ø°ÊÅØÔºö‰ªéÈ¢ÑÂîÆÂêàÁ∫¶Áõ¥Êé•Ëé∑ÂèñÂÆåÊï¥ÈÖçÁΩÆÔºåÂåÖÂê´ÈîôËØØÂ§ÑÁêÜÂíåÂõûÈÄÄÊú∫Âà∂
    async loadPresaleInfo() {
      const params = this.getUrlParams()

      try {
        console.log('üîç ÂºÄÂßãÂä†ËΩΩÈ¢ÑÂîÆÈÖçÁΩÆ‰ø°ÊÅØ...')

        // 1. Ëé∑ÂèñÈ¢ÑÂîÆÂêàÁ∫¶Âú∞ÂùÄ
        let presaleAddress = params.presaleAddress
        let tokenAddress = this.tokenInfo.contractAddress

        if (!presaleAddress && tokenAddress) {
          presaleAddress = await this.getPresaleAddressWithFallback(tokenAddress)
        }

        if (!presaleAddress || !this.validateAddress(presaleAddress)) {
          console.warn('‚ö†Ô∏è Êó†ÊúâÊïàÁöÑÈ¢ÑÂîÆÂêàÁ∫¶Âú∞ÂùÄÔºå‰ΩøÁî®ÈªòËÆ§ÈÖçÁΩÆ')
          this.showDefaultPresaleConfig()
          return
        }

        // ÁºìÂ≠òÊúâÊïàÁöÑÈ¢ÑÂîÆÂêàÁ∫¶Âú∞ÂùÄÔºå‰∏îÂÖ≥ËÅîÂΩìÂâç‰ª£Â∏ÅÂú∞ÂùÄÔºå‰æõenterPresaleÊñπÊ≥ï‰ΩøÁî®
        this.presaleContractAddress = presaleAddress
        this.presaleAddressToken = this.tokenInfo.contractAddress
        console.log('üíæ È¢ÑÂîÆÂêàÁ∫¶Âú∞ÂùÄÂ∑≤ÁºìÂ≠ò:', presaleAddress, 'for token:', this.presaleAddressToken)

        // 2. ‰ªéÈ¢ÑÂîÆÂêàÁ∫¶Ëé∑ÂèñÂÆåÊï¥ÈÖçÁΩÆ
        await this.loadPresaleConfigFromContract(presaleAddress)

      } catch (error) {
        console.error('‚ùå Âä†ËΩΩÈ¢ÑÂîÆ‰ø°ÊÅØÂ§±Ë¥•:', error)
        this.showDefaultPresaleConfig()
        this.$toast('È¢ÑÂîÆ‰ø°ÊÅØÂä†ËΩΩÂ§±Ë¥•ÔºåÊòæÁ§∫ÈªòËÆ§ÈÖçÁΩÆ')
      }
    },

    // Ëé∑ÂèñÈ¢ÑÂîÆÂú∞ÂùÄÔºåÂåÖÂê´ÂõûÈÄÄÊú∫Âà∂
    async getPresaleAddressWithFallback(tokenAddress) {
      try {
        console.log('üìç Â∞ùËØï‰ªéÂ∑•ÂéÇÂêàÁ∫¶Ëé∑ÂèñÈ¢ÑÂîÆÂú∞ÂùÄ:', tokenAddress)

        // ÊñπÊ≥ï1ÔºöÁõ¥Êé•ÈÄöËøá getTokenFullDetails Ëé∑Âèñ
        const tokenDetails = await coordinatorFactoryService.getTokenFullDetails(tokenAddress)
        const presaleAddress = tokenDetails.pair?.presaleAddress

        if (presaleAddress) {
          // ËΩ¨Êç¢‰∏∫ Base58 Ê†ºÂºè
          const base58Address = AddressUtils.toBase58(presaleAddress)
          console.log('üîÑ Âú∞ÂùÄÊ†ºÂºèËΩ¨Êç¢:', {
            ÂéüÂßãÂú∞ÂùÄ: presaleAddress,
            Base58Âú∞ÂùÄ: base58Address
          })

          if (this.validateAddress(base58Address)) {
            console.log('‚úÖ ÊàêÂäüËé∑ÂèñÈ¢ÑÂîÆÂú∞ÂùÄ:', base58Address)
            return base58Address
          } else {
            console.warn('‚ö†Ô∏è ËΩ¨Êç¢ÂêéÁöÑÂú∞ÂùÄÊ†ºÂºèÊó†Êïà:', base58Address)
          }
        }

        throw new Error('getTokenFullDetails ËøîÂõûÊó†ÊïàÂú∞ÂùÄ')

      } catch (error) {
        console.warn('‚ö†Ô∏è getTokenFullDetails Â§±Ë¥•ÔºåÂ∞ùËØïÁõ¥Êé•Êü•ËØ¢ÊñπÊ≥ï:', error.message)

        // ÊñπÊ≥ï2ÔºöÂ∞ùËØïÁõ¥Êé•ÈÄöËøá getTokenPresale Ëé∑Âèñ
        try {
          const presaleAddress = await coordinatorFactoryService.getTokenPresale(tokenAddress)
          if (presaleAddress) {
            // ËΩ¨Êç¢‰∏∫ Base58 Ê†ºÂºè
            const base58Address = AddressUtils.toBase58(presaleAddress)
            console.log('üîÑ Âú∞ÂùÄÊ†ºÂºèËΩ¨Êç¢:', {
              ÂéüÂßãÂú∞ÂùÄ: presaleAddress,
              Base58Âú∞ÂùÄ: base58Address
            })

            if (this.validateAddress(base58Address)) {
              console.log('‚úÖ ÈÄöËøáÁõ¥Êé•Êü•ËØ¢Ëé∑ÂèñÈ¢ÑÂîÆÂú∞ÂùÄ:', base58Address)
              return base58Address
            } else {
              console.warn('‚ö†Ô∏è ËΩ¨Êç¢ÂêéÁöÑÂú∞ÂùÄÊ†ºÂºè‰ªçÁÑ∂Êó†Êïà:', base58Address)
            }
          }
        } catch (directError) {
          console.warn('‚ö†Ô∏è Áõ¥Êé•Êü•ËØ¢‰πüÂ§±Ë¥•:', directError.message)
        }

        // ÊñπÊ≥ï3ÔºöÊúÄÂêéÁöÑÂõûÈÄÄÊñπÊ°à - ËøîÂõûnullË°®Á§∫Ê≤°ÊúâÈ¢ÑÂîÆÂêàÁ∫¶
        console.error('‚ùå ÊâÄÊúâÊñπÊ≥ïÈÉΩÂ§±Ë¥•ÔºåËØ•‰ª£Â∏ÅÂèØËÉΩÊ≤°ÊúâÈ¢ÑÂîÆÂêàÁ∫¶')
        return null
      }
    },

    // ‰ªéÂ∑•ÂéÇÂêàÁ∫¶Êü•ÊâæÊåáÂÆö‰ª£Â∏ÅÁöÑÈ¢ÑÂîÆÂêàÁ∫¶
    async findTokenPresaleInFactory(targetTokenAddress) {
      try {
        console.log('ÔøΩ Âú®Â∑•ÂéÇÂêàÁ∫¶‰∏≠Êü•ÊâæÊåáÂÆö‰ª£Â∏ÅÁöÑÈ¢ÑÂîÆÂêàÁ∫¶:', targetTokenAddress)

        // Ëé∑ÂèñÊâÄÊúâ‰ª£Â∏ÅÂØπ
        const totalPairs = await coordinatorFactoryService.getTotalPairsCreated()
        console.log('üìä Â∑•ÂéÇÂêàÁ∫¶ÊÄª‰ª£Â∏ÅÂØπÊï∞Èáè:', totalPairs)

        if (totalPairs === 0) {
          console.warn('‚ö†Ô∏è Â∑•ÂéÇÂêàÁ∫¶‰∏≠Ê≤°Êúâ‰ªª‰Ωï‰ª£Â∏ÅÂØπ')
          return null
        }

        const { pairs } = await coordinatorFactoryService.getAllTokenPresalePairs(0, totalPairs)

        if (!pairs || pairs.length === 0) {
          console.warn('‚ö†Ô∏è Â∑•ÂéÇÂêàÁ∫¶ËøîÂõûÁ©∫ÁöÑ‰ª£Â∏ÅÂØπÂàóË°®')
          return null
        }

        // Êü•ÊâæÂåπÈÖçÁöÑ‰ª£Â∏ÅÂØπ
        const targetPair = pairs.find(pair => {
          const tokenAddress = AddressUtils.toBase58(pair.tokenAddress || pair[0])
          return AddressUtils.isEqual(tokenAddress, targetTokenAddress)
        })

        if (targetPair) {
          const presaleAddress = AddressUtils.toBase58(targetPair.presaleAddress || targetPair[1])
          console.log('‚úÖ ÊâæÂà∞ÂåπÈÖçÁöÑ‰ª£Â∏ÅÂØπ:', {
            tokenAddress: targetTokenAddress,
            presaleAddress: presaleAddress
          })
          return presaleAddress
        } else {
          console.log('‚ùå Âú®Â∑•ÂéÇÂêàÁ∫¶‰∏≠Êú™ÊâæÂà∞ËØ•‰ª£Â∏ÅÁöÑÈ¢ÑÂîÆÂêàÁ∫¶')
          return null
        }

      } catch (error) {
        console.error('‚ùå Âú®Â∑•ÂéÇÂêàÁ∫¶‰∏≠Êü•Êâæ‰ª£Â∏ÅÂ§±Ë¥•:', error)
        return null
      }
    },

    // ÊòæÁ§∫ÈªòËÆ§È¢ÑÂîÆÈÖçÁΩÆ
    showDefaultPresaleConfig() {
      console.log('üìã ÊòæÁ§∫ÈªòËÆ§È¢ÑÂîÆÈÖçÁΩÆ')

      // ‰øùÊåÅÂΩìÂâçÁöÑÈªòËÆ§ÂÄºÔºåÁ°Æ‰øùÈ°µÈù¢Ê≠£Â∏∏ÊòæÁ§∫
      const defaultConfig = {
        tokenForLGE: '100%',
        tstTrxRate: '1 TST=1 TRX',
        softCap: '333 TRX',  // Á°¨È°∂ÁöÑ1/3
        hardCap: '1000 TRX',
        minBuy: '500 TRX',
        maxBuy: '500 TRX',
        startTime: '2025/08/15 14:14(4d 2h)',
        endTime: '2025/08/15 14:14(4d 2h)',
        duration: '90 days',
        vestingDelay: '10 days',
        vestingRate: '10%',
        vestingRounds: '5 rounds',
        trxPair: '25% TRX / 50% union',
        backing: '25% TRX / 50% union'
      }

      this.tokenInfo = { ...this.tokenInfo, ...defaultConfig }
    },

    // ‰ªéÈ¢ÑÂîÆÂêàÁ∫¶Áõ¥Êé•Ëé∑ÂèñÈÖçÁΩÆ‰ø°ÊÅØÔºåÂåÖÂê´ËØ¶ÁªÜÈîôËØØÂ§ÑÁêÜ
    async loadPresaleConfigFromContract(presaleAddress) {
      try {
        console.log('üìä ‰ªéÈ¢ÑÂîÆÂêàÁ∫¶Ëé∑ÂèñÈÖçÁΩÆ:', presaleAddress)

        const presaleService = new PresaleService(presaleAddress)

        // Âπ∂Ë°åËé∑ÂèñÊâÄÊúâÈÖçÁΩÆ‰ø°ÊÅØÔºåÊØè‰∏™Ë∞ÉÁî®ÈÉΩÊúâÁã¨Á´ãÁöÑÈîôËØØÂ§ÑÁêÜ
        const fullConfig = await this.getPresaleConfigWithRetry(presaleService)

        console.log('üìã Ëé∑ÂèñÂà∞ÁöÑÂÆåÊï¥ÈÖçÁΩÆ:', fullConfig)

        // Ê£ÄÊü•ÊòØÂê¶Ëé∑ÂèñÂà∞ÊúâÊïàÈÖçÁΩÆ
        const hasValidConfig = this.validatePresaleConfig(fullConfig)

        if (hasValidConfig) {
          // Êò†Â∞ÑÈÖçÁΩÆÊï∞ÊçÆÂà∞È°µÈù¢Â±ïÁ§∫Â≠óÊÆµ
          this.updateTokenInfoFromContractConfig(fullConfig)
          console.log('‚úÖ È¢ÑÂîÆÈÖçÁΩÆÂä†ËΩΩÊàêÂäü')
        } else {
          console.warn('‚ö†Ô∏è Ëé∑ÂèñÁöÑÈÖçÁΩÆÊó†ÊïàÔºå‰ΩøÁî®ÈªòËÆ§ÂÄº')
          this.showDefaultPresaleConfig()
        }

      } catch (error) {
        console.error('‚ùå ‰ªéÂêàÁ∫¶Ëé∑ÂèñÈÖçÁΩÆÂ§±Ë¥•:', error)

        // Ê†πÊçÆÈîôËØØÁ±ªÂûãÊèê‰æõ‰∏çÂêåÁöÑÂ§ÑÁêÜ
        if (error.message && error.message.includes('REVERT')) {
          console.warn('‚ö†Ô∏è ÂêàÁ∫¶Ë∞ÉÁî®Ë¢´ÂõûÈÄÄÔºåÂèØËÉΩÊòØÊó†ÊïàÁöÑÈ¢ÑÂîÆÂú∞ÂùÄ')
          this.$toast('È¢ÑÂîÆÂêàÁ∫¶Âú∞ÂùÄÊó†ÊïàÔºåÊòæÁ§∫ÈªòËÆ§ÈÖçÁΩÆ')
        } else if (error.message && error.message.includes('timeout')) {
          console.warn('‚ö†Ô∏è ÂêàÁ∫¶Ë∞ÉÁî®Ë∂ÖÊó∂')
          this.$toast('ÁΩëÁªúË∂ÖÊó∂ÔºåËØ∑Á®çÂêéÈáçËØï')
        } else {
          console.warn('‚ö†Ô∏è Êú™Áü•ÈîôËØØÔºå‰ΩøÁî®ÈªòËÆ§ÈÖçÁΩÆ')
          this.$toast('Âä†ËΩΩÈÖçÁΩÆÂ§±Ë¥•ÔºåÊòæÁ§∫ÈªòËÆ§ÈÖçÁΩÆ')
        }

        this.showDefaultPresaleConfig()
      }
    },

    // Â∏¶ÈáçËØïÊú∫Âà∂ÁöÑÈÖçÁΩÆËé∑Âèñ
    async getPresaleConfigWithRetry(presaleService, maxRetries = 2) {
      for (let attempt = 1; attempt <= maxRetries; attempt++) {
        try {
          console.log(`üîÑ Â∞ùËØïËé∑ÂèñÈÖçÁΩÆ (${attempt}/${maxRetries})...`)

          const fullConfig = await presaleService.getFullPresaleConfig()

          // Â¶ÇÊûúÊàêÂäüËé∑ÂèñÔºåÁõ¥Êé•ËøîÂõû
          if (fullConfig) {
            return fullConfig
          }

          throw new Error('Ëé∑ÂèñÁöÑÈÖçÁΩÆ‰∏∫Á©∫')

        } catch (error) {
          console.warn(`‚ö†Ô∏è Á¨¨ ${attempt} Ê¨°Â∞ùËØïÂ§±Ë¥•:`, error.message)

          if (attempt === maxRetries) {
            throw error // ÊúÄÂêé‰∏ÄÊ¨°Â∞ùËØïÂ§±Ë¥•ÔºåÊäõÂá∫ÈîôËØØ
          }

          // Á≠âÂæÖ‰∏ÄÊÆµÊó∂Èó¥ÂêéÈáçËØï
          await new Promise(resolve => setTimeout(resolve, 1000 * attempt))
        }
      }
    },

    // È™åËØÅÈ¢ÑÂîÆÈÖçÁΩÆÁöÑÊúâÊïàÊÄß
    validatePresaleConfig(config) {
      if (!config) {
        return false
      }

      const { lgeConfig, lpConfig, presaleConfig, tradeConfig } = config

      // Ëá≥Â∞ëÈúÄË¶ÅÊúâ‰∏Ä‰∏™ÈÖçÁΩÆ‰∏ç‰∏∫Á©∫
      const hasAnyConfig = lgeConfig || lpConfig || presaleConfig || tradeConfig

      console.log('üîç ÈÖçÁΩÆÈ™åËØÅÁªìÊûú:', {
        hasLGE: !!lgeConfig,
        hasLP: !!lpConfig,
        hasPresale: !!presaleConfig,
        hasTrade: !!tradeConfig,
        isValid: hasAnyConfig
      })

      return hasAnyConfig
    },

    // Â∞ÜÂêàÁ∫¶ÈÖçÁΩÆÊï∞ÊçÆÊò†Â∞ÑÂà∞È°µÈù¢Â±ïÁ§∫Â≠óÊÆµÔºåÂåÖÂê´ÂÆâÂÖ®ÁöÑÊï∞ÊçÆÂ§ÑÁêÜ
    updateTokenInfoFromContractConfig(config) {
      try {
        const { lgeConfig, lpConfig, presaleConfig, tradeConfig } = config || {}

        console.log('üîÑ Êò†Â∞ÑÈÖçÁΩÆÊï∞ÊçÆÂà∞È°µÈù¢Â≠óÊÆµ...', {
          hasLGE: !!lgeConfig,
          hasLP: !!lpConfig,
          hasPresale: !!presaleConfig,
          hasTrade: !!tradeConfig
        })

        const updates = {}
        let successfulMappings = 0

        // ‰ªé LGE ÈÖçÁΩÆÊò†Â∞ÑÂ≠óÊÆµ
        if (lgeConfig) {
          try {
            const lgeUpdates = this.mapLGEConfig(lgeConfig)
            Object.assign(updates, lgeUpdates)
            successfulMappings++
            console.log('‚úÖ LGE ÈÖçÁΩÆÊò†Â∞ÑÊàêÂäü')
          } catch (error) {
            console.warn('‚ö†Ô∏è LGE ÈÖçÁΩÆÊò†Â∞ÑÂ§±Ë¥•:', error)
          }
        }

        // ‰ªé LP ÈÖçÁΩÆÊò†Â∞ÑÂ≠óÊÆµ
        if (lpConfig) {
          try {
            const lpUpdates = this.mapLPConfig(lpConfig)
            Object.assign(updates, lpUpdates)
            successfulMappings++
            console.log('‚úÖ LP ÈÖçÁΩÆÊò†Â∞ÑÊàêÂäü')
          } catch (error) {
            console.warn('‚ö†Ô∏è LP ÈÖçÁΩÆÊò†Â∞ÑÂ§±Ë¥•:', error)
          }
        }

        // ‰ªéÈ¢ÑÂîÆÈÖçÁΩÆÊò†Â∞ÑÂ≠óÊÆµ
        if (presaleConfig) {
          try {
            console.log('üîç È¢ÑÂîÆÈÖçÁΩÆÂØπË±°ËØ¶ÊÉÖ:', {
              ÂÆåÊï¥ÂØπË±°: presaleConfig,
              preSaleMaxNum: presaleConfig.preSaleMaxNum,
              preSaleEthAmount: presaleConfig.preSaleEthAmount,
              preSaleMaxNumÁ±ªÂûã: typeof presaleConfig.preSaleMaxNum,
              ÊâÄÊúâÂ±ûÊÄß: Object.keys(presaleConfig),
              È¢ÑÂîÆÈÖçÁΩÆJSON: JSON.stringify(presaleConfig, null, 2)
            })
            
            const presaleUpdates = this.mapPresaleConfig(presaleConfig)
            console.log('üîç È¢ÑÂîÆÈÖçÁΩÆÊò†Â∞ÑÁªìÊûú:', presaleUpdates)
            
            Object.assign(updates, presaleUpdates)
            successfulMappings++
            console.log('‚úÖ È¢ÑÂîÆÈÖçÁΩÆÊò†Â∞ÑÊàêÂäü')
          } catch (error) {
            console.warn('‚ö†Ô∏è È¢ÑÂîÆÈÖçÁΩÆÊò†Â∞ÑÂ§±Ë¥•:', error)
          }
        }

        // ‰ªé‰∫§ÊòìÈÖçÁΩÆÊò†Â∞ÑÂ≠óÊÆµ
        if (tradeConfig) {
          try {
            const tradeUpdates = this.mapTradeConfig(tradeConfig)
            Object.assign(updates, tradeUpdates)
            successfulMappings++
            console.log('‚úÖ ‰∫§ÊòìÈÖçÁΩÆÊò†Â∞ÑÊàêÂäü')
          } catch (error) {
            console.warn('‚ö†Ô∏è ‰∫§ÊòìÈÖçÁΩÆÊò†Â∞ÑÂ§±Ë¥•:', error)
          }
        }

        // Âè™ÊúâÂú®ÊàêÂäüÊò†Â∞ÑËá≥Â∞ë‰∏Ä‰∏™ÈÖçÁΩÆÊó∂ÊâçÊõ¥Êñ∞
        if (successfulMappings > 0) {
          console.log('üîç Êõ¥Êñ∞ÂâçÁöÑ tokenInfo.tokenForLGE:', this.tokenInfo.tokenForLGE)
          console.log('üîç Âç≥Â∞ÜÂ∫îÁî®ÁöÑÊõ¥Êñ∞:', JSON.stringify(updates, null, 2))
          this.tokenInfo = { ...this.tokenInfo, ...updates }
          
          // Ê£ÄÊü•Á°¨È°∂ÂíåÊúÄÂ§ßË¥≠‰π∞ÈáèÊòØÂê¶Ê≠£Á°ÆÊ†ºÂºèÂåñ
          if (this.tokenInfo.hardCap && this.tokenInfo.hardCap.includes('1000000000.00M')) {
            console.log('üîç Á°¨È°∂ÂÄº:', this.tokenInfo.hardCap)
          }
          
          if (this.tokenInfo.maxBuy && this.tokenInfo.maxBuy.includes('100000000.00M')) {
            console.log('üîç ÊúÄÂ§ßË¥≠‰π∞ÈáèÂÄº:', this.tokenInfo.maxBuy)
          }
          
          // Ê£ÄÊü• Token for LGE ÊòØÂê¶Ê≠£Á°ÆËÆæÁΩÆ
          if (this.tokenInfo.tokenForLGE === '0' || this.tokenInfo.tokenForLGE === 0) {
            console.warn('‚ö†Ô∏è Ê£ÄÊµãÂà∞ Token for LGE ‰∏∫ 0ÔºåÂ∞ùËØïÂº∫Âà∂ËÆæÁΩÆ')
            console.log('üîç ÂΩìÂâç tokenInfo.tokenForLGE:', this.tokenInfo.tokenForLGE)
            console.log('üîç È¢ÑÂîÆÈÖçÁΩÆÊõ¥Êñ∞‰∏≠ÁöÑ tokenForLGE:', updates.tokenForLGE)
            console.log('üîç È¢ÑÂîÆÈÖçÁΩÆÊõ¥Êñ∞ÂÆåÊï¥ÂÜÖÂÆπ:', JSON.stringify(updates, null, 2))
            
            // Â¶ÇÊûúÈ¢ÑÂîÆÈÖçÁΩÆ‰∏≠Êúâ tokenForLGEÔºåÂº∫Âà∂Â∫îÁî®
            if (updates.tokenForLGE && updates.tokenForLGE !== '0') {
              console.log('üîß Âº∫Âà∂Â∫îÁî®È¢ÑÂîÆÈÖçÁΩÆ‰∏≠ÁöÑ tokenForLGE:', updates.tokenForLGE)
              this.tokenInfo.tokenForLGE = updates.tokenForLGE
              console.log('üîß Âº∫Âà∂Â∫îÁî®ÂêéÁöÑ tokenInfo.tokenForLGE:', this.tokenInfo.tokenForLGE)
            } else {
              console.warn('‚ö†Ô∏è È¢ÑÂîÆÈÖçÁΩÆÊõ¥Êñ∞‰∏≠Ê≤°ÊúâÊúâÊïàÁöÑ tokenForLGE ÂÄº')
            }
          }
          
          console.log('üîç Êõ¥Êñ∞ÂêéÁöÑ tokenInfo.tokenForLGE:', this.tokenInfo.tokenForLGE)
          console.log(`‚úÖ ÈÖçÁΩÆÊï∞ÊçÆÊò†Â∞ÑÂÆåÊàêÔºåÊàêÂäüÊò†Â∞Ñ ${successfulMappings} ‰∏™ÈÖçÁΩÆ`)
        } else {
          console.warn('‚ö†Ô∏è Ê≤°ÊúâÊàêÂäüÊò†Â∞Ñ‰ªª‰ΩïÈÖçÁΩÆÔºå‰øùÊåÅÈªòËÆ§ÂÄº')
        }

      } catch (error) {
        console.error('‚ùå ÈÖçÁΩÆÊï∞ÊçÆÊò†Â∞ÑËøáÁ®ã‰∏≠ÂèëÁîüÈîôËØØ:', error)
      }
    },

    // Êò†Â∞Ñ LGE ÈÖçÁΩÆ
    mapLGEConfig(lgeConfig) {
      const updates = {}

      // Ê∑ªÂä†ÂéüÂßãÊï∞ÊçÆË∞ÉËØïÊó•Âøó
      console.log('üîç LGEÈÖçÁΩÆÂéüÂßãÊï∞ÊçÆ:', {
        startTime: lgeConfig.startTime,
        hardcap: lgeConfig.hardcap,
        maxBuyPerWallet: lgeConfig.maxBuyPerWallet,
        vestingDelay: lgeConfig.vestingDelay,
        vestingRate: lgeConfig.vestingRate
      })

      if (lgeConfig.startTime) {
        updates.startTime = this.formatTimestamp(lgeConfig.startTime)
      }

      if (lgeConfig.hardcap) {
        console.log(`üéØ Â§ÑÁêÜÁ°¨È°∂Êï∞ÊçÆ: ${lgeConfig.hardcap} (Á±ªÂûã: ${typeof lgeConfig.hardcap})`)
        console.log(`üîç Á°¨È°∂ÂéüÂßãÂÄºËØ¶ÊÉÖ:`, {
          ÂéüÂßãÂÄº: lgeConfig.hardcap,
          Á±ªÂûã: typeof lgeConfig.hardcap,
          ÊòØÂê¶‰∏∫Êï∞Â≠ó: !isNaN(Number(lgeConfig.hardcap)),
          Êï∞ÂÄº: Number(lgeConfig.hardcap)
        })
        const formattedHardCap = this.formatTrxAmount(lgeConfig.hardcap, true) // Ê†áËÆ∞‰∏∫Á°¨È°∂
        updates.hardCap = formattedHardCap
        console.log(`üéØ Á°¨È°∂Ê†ºÂºèÂåñÁªìÊûú: ${formattedHardCap}`)
        // Ëá™Âä®ËÆ°ÁÆóËΩØÈ°∂ÔºàÁ°¨È°∂ÁöÑ1/3Ôºâ
        updates.softCap = this.calculateSoftCap(formattedHardCap)
      }

      if (lgeConfig.maxBuyPerWallet) {
        console.log(`üí∞ Â§ÑÁêÜÊúÄÂ§ßË¥≠‰π∞Êï∞ÊçÆ: ${lgeConfig.maxBuyPerWallet} (Á±ªÂûã: ${typeof lgeConfig.maxBuyPerWallet})`)
        console.log(`üîç ÊúÄÂ§ßË¥≠‰π∞ÂéüÂßãÂÄºËØ¶ÊÉÖ:`, {
          ÂéüÂßãÂÄº: lgeConfig.maxBuyPerWallet,
          Á±ªÂûã: typeof lgeConfig.maxBuyPerWallet,
          ÊòØÂê¶‰∏∫Êï∞Â≠ó: !isNaN(Number(lgeConfig.maxBuyPerWallet)),
          Êï∞ÂÄº: Number(lgeConfig.maxBuyPerWallet)
        })
        const formattedMaxBuy = this.formatTrxAmount(lgeConfig.maxBuyPerWallet, true) // Ê†áËÆ∞‰∏∫ÊúÄÂ§ßË¥≠‰π∞Èáè
        updates.maxBuy = formattedMaxBuy
        console.log(`üí∞ ÊúÄÂ§ßË¥≠‰π∞Ê†ºÂºèÂåñÁªìÊûú: ${formattedMaxBuy}`)
      }

      if (lgeConfig.vestingDelay) {
        updates.vestingDelay = this.formatDuration(lgeConfig.vestingDelay)
      }

      if (lgeConfig.vestingRate) {
        updates.vestingRate = `${lgeConfig.vestingRate}%`
        updates.vestingRounds = this.calculateVestingRounds(updates.vestingRate)
      }

      if (lgeConfig.backingShare || lgeConfig.backingReceiver) {
        updates.backing = this.formatBackingInfo(lgeConfig.backingShare, lgeConfig.backingReceiver)
      }

      // ËÆ°ÁÆóÁªìÊùüÊó∂Èó¥ÂíåÊåÅÁª≠Êó∂Èó¥
      if (lgeConfig.startTime && lgeConfig.vestingDelay) {
        updates.endTime = this.calculateEndTime(lgeConfig.startTime, lgeConfig.vestingDelay)
        updates.duration = this.calculateDuration(lgeConfig.startTime, updates.endTime)
      }

      return updates
    },

    // Êò†Â∞Ñ LP ÈÖçÁΩÆ
    mapLPConfig(lpConfig) {
      const updates = {}

      if (lpConfig.userShare && lpConfig.devShare) {
        updates.trxPair = this.formatLpDistribution(lpConfig.userShare, lpConfig.devShare)
      }

      return updates
    },

    // Êò†Â∞ÑÈ¢ÑÂîÆÈÖçÁΩÆ
    mapPresaleConfig(presaleConfig) {
      const updates = {}

      console.log('üîç È¢ÑÂîÆÈÖçÁΩÆÂéüÂßãÊï∞ÊçÆ:', {
        preSaleMaxNum: presaleConfig.preSaleMaxNum,
        preSaleEthAmount: presaleConfig.preSaleEthAmount,
        preSaleMaxNumÁ±ªÂûã: typeof presaleConfig.preSaleMaxNum
      })

      if (presaleConfig.preSaleMaxNum !== undefined && presaleConfig.preSaleMaxNum !== null) {
        // ‰ΩøÁî®ÈªòËÆ§ÁöÑ18‰ΩçdecimalsÔºåÂõ†‰∏∫ËøôÈáåÊ≤°ÊúâÂÖ∑‰ΩìÁöÑdecimals‰ø°ÊÅØ
        console.log(`üîç Â§ÑÁêÜ preSaleMaxNum: ${presaleConfig.preSaleMaxNum} (Á±ªÂûã: ${typeof presaleConfig.preSaleMaxNum})`)
        console.log(`üîç preSaleMaxNum Êï∞ÂÄºÊ£ÄÊü•:`, {
          ÂÄº: presaleConfig.preSaleMaxNum,
          Á±ªÂûã: typeof presaleConfig.preSaleMaxNum,
          ÊòØÂê¶‰∏∫BigInt: typeof presaleConfig.preSaleMaxNum === 'bigint',
          ËΩ¨Êç¢‰∏∫Â≠óÁ¨¶‰∏≤: presaleConfig.preSaleMaxNum.toString(),
          ËΩ¨Êç¢‰∏∫Êï∞Â≠ó: Number(presaleConfig.preSaleMaxNum)
        })
        
        updates.tokenForLGE = this.formatTokenAmount(presaleConfig.preSaleMaxNum, 18)
        console.log(`üîç tokenForLGE Ê†ºÂºèÂåñÁªìÊûú: ${updates.tokenForLGE}`)
      } else {
        console.warn('‚ö†Ô∏è preSaleMaxNum ‰∏∫Á©∫ÊàñÊú™ÂÆö‰πâ')
      }

      if (presaleConfig.preSaleEthAmount) {
        updates.minBuy = this.formatTrxAmount(presaleConfig.preSaleEthAmount, false, true)
      }

      // Ê≥®ÊÑèÔºöËΩØÈ°∂Áé∞Âú®Âú® mapLGEConfig ‰∏≠Ëá™Âä®ËÆ°ÁÆóÔºåÊó†ÈúÄÂú®Ê≠§Â§ÑÈáçÂ§çËÆ°ÁÆó

      return updates
    },

    // Âä®ÊÄÅËÆ°ÁÆóËΩØÈ°∂ÔºàÁ°¨È°∂ÁöÑ1/3Ôºâ- ‰øÆÂ§çÔºöÊîπËøõÊï∞ÂÄºÊèêÂèñÂíåÂ§ÑÁêÜÈÄªËæë
    calculateSoftCap(hardCapValue) {
      try {
        if (!hardCapValue || hardCapValue === 0) {
          console.log('‚ö†Ô∏è Á°¨È°∂ÂÄº‰∏∫Á©∫Ôºå‰ΩøÁî®ÈªòËÆ§ËΩØÈ°∂')
          return '333 TRX'  // ÈªòËÆ§ÂÄº
        }

        // Â¶ÇÊûúÁ°¨È°∂ÊòØÂ≠óÁ¨¶‰∏≤Ê†ºÂºèÔºåÊèêÂèñÊï∞ÂÄº
        let numericValue = hardCapValue
        if (typeof hardCapValue === 'string') {
          // ÊèêÂèñÊï∞Â≠óÈÉ®ÂàÜÔºåÂ§ÑÁêÜÂ∏¶ÈÄóÂè∑ÁöÑÊï∞Â≠óÂíåÁßëÂ≠¶ËÆ°Êï∞Ê≥ïÔºå‰æãÂ¶Ç "1,000,000,000,000,000 TRX" -> 1000000000000000
          const cleanString = hardCapValue.replace(/[,\s]/g, '') // ÁßªÈô§ÈÄóÂè∑ÂíåÁ©∫Ê†º
          const match = cleanString.match(/(\d+(?:\.\d+)?(?:[eE][+-]?\d+)?)/);
          if (match) {
            numericValue = parseFloat(match[1])
            console.log(`üîç ‰ªéÁ°¨È°∂Â≠óÁ¨¶‰∏≤ÊèêÂèñÊï∞ÂÄº: "${hardCapValue}" -> ${numericValue}`)

            // Ê£ÄÊü•ÊòØÂê¶ÊòØÂºÇÂ∏∏Â§ßÁöÑÊï∞ÂÄºÔºàÂèØËÉΩÊòØÂçï‰ΩçÈîôËØØÔºâ
            if (numericValue > 1000000000) { // Ë∂ÖËøá10‰∫ø
              console.warn(`‚ö†Ô∏è Ê£ÄÊµãÂà∞ÂºÇÂ∏∏Â§ßÁöÑÁ°¨È°∂Êï∞ÂÄº: ${numericValue}ÔºåÂèØËÉΩÈúÄË¶ÅÂçï‰ΩçËΩ¨Êç¢`)
              // Â∞ùËØïÈô§‰ª•Â∏∏ËßÅÁöÑÂçï‰ΩçËΩ¨Êç¢Âõ†Â≠ê
              if (numericValue > 1e15) { // Ë∂ÖËøáÂçÉ‰∏á‰∫øÔºåÂèØËÉΩÊòØweiÂçï‰Ωç
                numericValue = numericValue / 1e18 // Èô§‰ª•10^18
                console.log(`üîÑ Â∫îÁî®weiÂà∞etherËΩ¨Êç¢: ${numericValue}`)
              } else if (numericValue > 1e12) { // Ë∂ÖËøá‰∏á‰∫øÔºåÂèØËÉΩÊòØsunÂçï‰Ωç
                numericValue = numericValue / 1e6 // Èô§‰ª•10^6 (SUNÂà∞TRX)
                console.log(`üîÑ Â∫îÁî®SUNÂà∞TRXËΩ¨Êç¢: ${numericValue}`)
              }
            }
          } else {
            console.warn('‚ö†Ô∏è Êó†Ê≥ï‰ªéÁ°¨È°∂Â≠óÁ¨¶‰∏≤‰∏≠ÊèêÂèñÊï∞ÂÄº:', hardCapValue)
            return '333 TRX'
          }
        }

        // ËÆ°ÁÆóËΩØÈ°∂ = Á°¨È°∂ / 3
        const softCapValue = Math.round(numericValue / 3)

        // Ê†ºÂºèÂåñÊòæÁ§∫
        let formattedSoftCap
        if (softCapValue >= 1000000) {
          formattedSoftCap = `${(softCapValue / 1000000).toFixed(2)}M TRX`
        } else if (softCapValue >= 1000) {
          formattedSoftCap = `${(softCapValue / 1000).toFixed(2)}K TRX`
        } else {
          formattedSoftCap = `${softCapValue.toLocaleString()} TRX`
        }

        console.log(`üí∞ ËΩØÈ°∂Âä®ÊÄÅËÆ°ÁÆó: ${numericValue} / 3 = ${softCapValue} -> ${formattedSoftCap}`)
        return formattedSoftCap

      } catch (error) {
        console.error('‚ùå ËΩØÈ°∂ËÆ°ÁÆóÂ§±Ë¥•:', error)
        return '333 TRX'  // ËøîÂõûÈªòËÆ§ÂÄº
      }
    },

    // Êõ¥Êñ∞Á°¨È°∂Êó∂Ëá™Âä®ÈáçÊñ∞ËÆ°ÁÆóËΩØÈ°∂
    updateHardCapAndRecalculateSoftCap(newHardCap) {
      try {
        // Êõ¥Êñ∞Á°¨È°∂
        this.tokenInfo.hardCap = newHardCap

        // Ëá™Âä®ÈáçÊñ∞ËÆ°ÁÆóËΩØÈ°∂
        this.tokenInfo.softCap = this.calculateSoftCap(newHardCap)

        console.log('üîÑ Á°¨È°∂Êõ¥Êñ∞ÔºåËΩØÈ°∂Ëá™Âä®ÈáçÊñ∞ËÆ°ÁÆó:', {
          hardCap: newHardCap,
          softCap: this.tokenInfo.softCap
        })

      } catch (error) {
        console.error('‚ùå Á°¨È°∂Êõ¥Êñ∞ÂíåËΩØÈ°∂ÈáçÊñ∞ËÆ°ÁÆóÂ§±Ë¥•:', error)
      }
    },

    // Êò†Â∞Ñ‰∫§ÊòìÈÖçÁΩÆ
    mapTradeConfig(tradeConfig) {
      const updates = {}

      if (tradeConfig.tradeEthAmount) {
        updates.tstTrxRate = this.formatExchangeRate(tradeConfig.tradeEthAmount)
      }

      return updates
    },

    // Ê∑ªÂä†Ëøô‰∫õÊñ∞ÊñπÊ≥ï
    getUrlParams() {
      const route = this.$route || {};
      console.log('üîç Ëß£ÊûêË∑ØÁî±ÂèÇÊï∞:', {
        route: route,
        fullPath: route.fullPath,
        query: route.query,
        params: route.params
      });

      // 1) ‰ºòÂÖà‰ΩøÁî® Vue Router ÁöÑ query
      let index = route.query && route.query.index !== undefined ? route.query.index : undefined;
      let tokenAddress = route.query && route.query.tokenAddress;
      let presaleAddress = route.query && route.query.presaleAddress;
      let creator = route.query && route.query.creator;
      let tokenId = route.params && route.params.id;

      // 2) Â¶ÇÊûú Vue Router Ê≤°ÊúâËß£ÊûêÂà∞Êü•ËØ¢ÂèÇÊï∞ÔºåÂ∞ùËØïÊâãÂä®Ëß£Êûê URL
      if (index === undefined || !tokenAddress) {
        try {
          // Ëß£ÊûêÂÆåÊï¥ÁöÑ URLÔºåÂåÖÊã¨ÂìàÂ∏åÈÉ®ÂàÜ
          const fullUrl = window.location.href;
          const url = new URL(fullUrl);
          
          // Ê£ÄÊü•ÂìàÂ∏å‰∏≠ÁöÑÊü•ËØ¢ÂèÇÊï∞
          const hash = url.hash || '';
          if (hash.includes('?')) {
            const hashQuery = hash.split('?')[1];
            const hashParams = new URLSearchParams(hashQuery);
            
            if (index === undefined) {
              const hashIndex = hashParams.get('index');
              if (hashIndex !== null && hashIndex !== '') {
                index = hashIndex;
                console.log('üîç ‰ªéÂìàÂ∏åÊü•ËØ¢ÂèÇÊï∞Ëß£ÊûêÂà∞ index:', index);
              }
            }
            
            if (!tokenAddress) {
              const hashTokenAddress = hashParams.get('tokenAddress');
              if (hashTokenAddress) {
                tokenAddress = hashTokenAddress;
                console.log('üîç ‰ªéÂìàÂ∏åÊü•ËØ¢ÂèÇÊï∞Ëß£ÊûêÂà∞ tokenAddress:', tokenAddress);
              }
            }
            
            if (!presaleAddress) {
              const hashPresaleAddress = hashParams.get('presaleAddress');
              if (hashPresaleAddress) {
                presaleAddress = hashPresaleAddress;
              }
            }
            
            if (!creator) {
              const hashCreator = hashParams.get('creator');
              if (hashCreator) {
                creator = hashCreator;
              }
            }
          }
          
          // Ê£ÄÊü• URL ÊêúÁ¥¢ÂèÇÊï∞ÔºàÂìàÂ∏åÂâçÁöÑÈÉ®ÂàÜÔºâ
          if (index === undefined) {
            const searchIndex = url.searchParams.get('index');
            if (searchIndex !== null && searchIndex !== '') {
              index = searchIndex;
              console.log('üîç ‰ªé URL ÊêúÁ¥¢ÂèÇÊï∞Ëß£ÊûêÂà∞ index:', index);
            }
          }
          
          if (!tokenAddress) {
            const searchTokenAddress = url.searchParams.get('tokenAddress');
            if (searchTokenAddress) {
              tokenAddress = searchTokenAddress;
              console.log('üîç ‰ªé URL ÊêúÁ¥¢ÂèÇÊï∞Ëß£ÊûêÂà∞ tokenAddress:', tokenAddress);
            }
          }
          
        } catch (e) {
          console.warn('‚ö†Ô∏è Ëß£Êûê URL ÂèÇÊï∞Â§±Ë¥•:', e);
        }
      }

      console.log('üìã ÊúÄÁªàËß£ÊûêÁöÑÂèÇÊï∞:', { tokenId, tokenAddress, presaleAddress, creator, index });
      return { tokenId, tokenAddress, presaleAddress, creator, index };
    },

    // Â∞Ü URL ‰∏≠ÔºàÊó†ËÆ∫Âú® # ÂâçËøòÊòØ # ÂêéÔºâÁöÑ index/id ÂêåÊ≠•Âà∞ Vue Router ÁöÑ $route
    syncUrlParamsToRouter() {
      try {
        const { tokenId, index, tokenAddress, presaleAddress, creator } = this.getUrlParams();
        const curr = this.$route;
        
        // Ê£ÄÊü•ÊòØÂê¶ÈúÄË¶ÅÂêåÊ≠•ÂêÑÁßçÂèÇÊï∞
        const needIndexSync = index !== undefined && curr.query.index !== index;
        const needIdSync = tokenId && curr.params.id !== tokenId;
        const needTokenAddressSync = tokenAddress && curr.query.tokenAddress !== tokenAddress;
        const needPresaleAddressSync = presaleAddress && curr.query.presaleAddress !== presaleAddress;
        const needCreatorSync = creator && curr.query.creator !== creator;

        if (needIndexSync || needIdSync || needTokenAddressSync || needPresaleAddressSync || needCreatorSync) {
          // ÊûÑÂª∫Êñ∞ÁöÑÊü•ËØ¢ÂèÇÊï∞
          const newQuery = { ...curr.query };
          if (index !== undefined) newQuery.index = index.toString();
          if (tokenAddress) newQuery.tokenAddress = tokenAddress;
          if (presaleAddress) newQuery.presaleAddress = presaleAddress;
          if (creator) newQuery.creator = creator;

          // ÊûÑÂª∫Êñ∞ÁöÑË∑ØÂæÑÂèÇÊï∞
          const newParams = { ...curr.params };
          if (tokenId) newParams.id = tokenId;

          this.$router.replace({
            name: curr.name || 'tokenDetail',
            params: newParams,
            query: newQuery
          }).catch(() => {});
          
          console.log('üîÅ Â∑≤Â∞Ü URL ÂèÇÊï∞ÂêåÊ≠•Âà∞Ë∑ØÁî±:', { 
            tokenId, 
            index, 
            tokenAddress,
            presaleAddress,
            creator,
            fullPath: this.$route.fullPath 
          });
        }
      } catch (e) {
        console.warn('‚ö†Ô∏è ÂêåÊ≠• URL ÂèÇÊï∞Âà∞Ë∑ØÁî±Â§±Ë¥•:', e);
      }
    },

    validateAddress(address) {
      if (!address) return false;
      const tronAddressRegex = /^T[A-Za-z1-9]{33}$/;
      return tronAddressRegex.test(address);
    },



    // ËÆæÁΩÆÊ¥ªÂä®ÊåâÈíÆ
    setActiveButton(index) {
      this.activeButton = index;
    },

    /**
     * ÂØºËà™Âà∞ÊåáÂÆöÁ¥¢ÂºïÁöÑ‰ª£Â∏Å
     * @param {number} index - ÁõÆÊ†áÁ¥¢Âºï
     */
    async navigateToTokenIndex(index) {
      console.log(`üîÑ ÂØºËà™Âà∞‰ª£Â∏ÅÁ¥¢Âºï: ${this.currentTokenIndex} ‚Üí ${index}`);
      console.log(`üìä ÂΩìÂâçÁä∂ÊÄÅ: ÊÄªÊï∞=${this.totalTokenCount}, ÂΩìÂâçÁ¥¢Âºï=${this.currentTokenIndex}`);

      this.loading = true;

      try {
        await this.loadTokenByIndex(index);
        console.log(`‚úÖ ÂØºËà™ÊàêÂäü: Êñ∞Á¥¢Âºï=${this.currentTokenIndex}`);
      } catch (error) {
        console.error('‚ùå ÂØºËà™Âà∞‰ª£Â∏ÅÁ¥¢ÂºïÂ§±Ë¥•:', error);
        this.$toast('ÂàáÊç¢‰ª£Â∏ÅÂ§±Ë¥•');
      } finally {
        this.loading = false;
      }
    },

    /**
     * Ëé∑ÂèñÂΩìÂâç‰ª£Â∏ÅÁ¥¢Âºï
     */
    getCurrentTokenIndex() {
      // ‰ºòÂÖà‰ΩøÁî®Êú¨Âú∞Áä∂ÊÄÅÔºåÂ¶ÇÊûúÊ≤°ÊúâÂàô‰ªéURLÂèÇÊï∞Ëé∑Âèñ
      if (this.currentTokenIndex !== undefined) {
        return this.currentTokenIndex;
      }

      const params = this.getUrlParams();
      const indexFromUrl = params.index ? parseInt(params.index) : 0;
      this.currentTokenIndex = indexFromUrl;
      return indexFromUrl;
    },

    /**
     * ÂØºËà™Âà∞‰∏ã‰∏Ä‰∏™‰ª£Â∏Å
     */
    async navigateToNextToken() {
      const currentIndex = this.currentTokenIndex;
      const nextIndex = currentIndex + 1;

      console.log(`üîÑ ÂØºËà™Âà∞‰∏ã‰∏Ä‰∏™‰ª£Â∏Å: ${currentIndex} ‚Üí ${nextIndex}`);

      if (nextIndex < this.totalTokenCount) {
        await this.navigateToTokenIndex(nextIndex);
      } else {
        console.warn(`‚ö†Ô∏è Â∑≤ÁªèÊòØÊúÄÂêé‰∏Ä‰∏™‰ª£Â∏Å (Á¥¢Âºï ${currentIndex})`);
        this.$toast('Â∑≤ÁªèÊòØÊúÄÂêé‰∏Ä‰∏™‰ª£Â∏Å');
      }
    },

    /**
     * ÂØºËà™Âà∞‰∏ä‰∏Ä‰∏™‰ª£Â∏Å
     */
    async navigateToPreviousToken() {
      const currentIndex = this.currentTokenIndex;
      const prevIndex = currentIndex - 1;

      console.log(`üîÑ ÂØºËà™Âà∞‰∏ä‰∏Ä‰∏™‰ª£Â∏Å: ${currentIndex} ‚Üí ${prevIndex}`);

      if (prevIndex >= 0) {
        await this.navigateToTokenIndex(prevIndex);
      } else {
        console.warn(`‚ö†Ô∏è Â∑≤ÁªèÊòØÁ¨¨‰∏Ä‰∏™‰ª£Â∏Å (Á¥¢Âºï ${currentIndex})`);
        this.$toast('Â∑≤ÁªèÊòØÁ¨¨‰∏Ä‰∏™‰ª£Â∏Å');
      }
    },

    // Ê†ºÂºèÂåñÂú∞ÂùÄÊòæÁ§∫
    formatAddress(address) {
      if (!address) return '';
      return `${address.slice(0, 6)}...${address.slice(-6)}`;
    },
    // Âä†ËΩΩÁî®Êà∑‰ΩôÈ¢ù
    async loadUserBalance() {
      try {
        if (window.tronWeb && window.tronWeb.defaultAddress.base58) {
          const balance = await window.tronWeb.trx.getBalance();
          const balanceInTrx = window.tronWeb.fromSun(balance);
          this.trxBalance = balanceInTrx;
          this.userTrxBalance = balanceInTrx; // ÂêåÊó∂Êõ¥Êñ∞ÁªëÂÆöÊõ≤Á∫øÈ¢ÑÂîÆÁöÑ‰ΩôÈ¢ù
        }
      } catch (error) {
        console.error('Failed to load user balance:', error);
        // ‰øùÊåÅÈªòËÆ§‰ΩôÈ¢ù
      }
    },
    // Ê†ºÂºèÂåñÊï∞Â≠óÊòæÁ§∫
    formatNumber(num) {
      if (typeof num === 'string') {
        return num;
      }
      return num.toLocaleString();
    },

    // Â§çÂà∂Âú∞ÂùÄÂà∞Ââ™Ë¥¥Êùø
    async copyAddress(address) {
      try {
        if (navigator.clipboard) {
          await navigator.clipboard.writeText(address);
          this.$toast('Âú∞ÂùÄÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø');
        } else {
          const textArea = document.createElement('textarea');
          textArea.value = address;
          textArea.style.position = 'fixed';
          textArea.style.opacity = '0';
          document.body.appendChild(textArea);
          textArea.select();
          try {
            document.execCommand('copy');
            this.$toast('Âú∞ÂùÄÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø');
          } catch (err) {
            console.error('Fallback copy failed:', err);
            this.$toast('Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Â§çÂà∂');
          }
          document.body.removeChild(textArea);
        }
      } catch (error) {
        console.error('Failed to copy address:', error);
        this.$toast('Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Â§çÂà∂');
      }
    },

    // Âú®Âå∫ÂùóÈìæÊµèËßàÂô®‰∏≠ÊâìÂºÄÂú∞ÂùÄ
    openInExplorer(address) {
      const explorerUrl = `https://tronscan.org/#/address/${address}`;
      window.open(explorerUrl, '_blank');
    },

    // Á§æ‰∫§Â™í‰ΩìÈìæÊé•
    openTwitter() {
      window.open('https://twitter.com/chou_token', '_blank');
    },

    openTelegram() {
      window.open('https://t.me/chou_token', '_blank');
    },

    openWebsite() {
      window.open('https://chou.token', '_blank');
    },

    // ËÆæÁΩÆÊúÄÂ§ßÈ¢ÑÂîÆÊï∞Èáè
    setMaxPresaleAmount() {
      this.presaleInputAmount = this.trxBalance.toString();
    },

    // ËøõÂÖ•È¢ÑÂîÆ
    async enterPresale() {
      if (!this.presaleInputAmount || parseFloat(this.presaleInputAmount) <= 0) {
        this.$toast('ËØ∑ËæìÂÖ•ÊúâÊïàÊï∞Èáè');
        return;
      }

      const amount = parseFloat(this.presaleInputAmount);
      if (amount > this.trxBalance) {
        this.$toast('‰ΩôÈ¢ù‰∏çË∂≥');
        return;
      }

      console.log('ËøõÂÖ•È¢ÑÂîÆ:', amount);
      this.$toast('È¢ÑÂîÆËØ∑Ê±ÇÂ∑≤Êèê‰∫§');

      setTimeout(() => {
        this.presaleInputAmount = '';
        this.$toast('È¢ÑÂîÆÊàêÂäüÔºÅ');
      }, 2000);
    },

    // === ÁªëÂÆöÊõ≤Á∫øÈ¢ÑÂîÆÁõ∏ÂÖ≥ÊñπÊ≥ï ===

    // Ê†ºÂºèÂåñ‰ΩôÈ¢ùÊòæÁ§∫
    formatBalance(balance) {
      if (!balance) return '0';
      return Number(balance).toLocaleString();
    },

    // È™åËØÅÈ¢ÑÂîÆÈáëÈ¢ù
    validatePresaleAmount() {
      this.presaleValidationError = '';

      const amount = parseFloat(this.presaleAmount);

      if (!this.presaleAmount || isNaN(amount)) {
        return;
      }

      if (amount <= 0) {
        this.presaleValidationError = 'ÈáëÈ¢ùÂøÖÈ°ªÂ§ß‰∫é0';
        return;
      }

      if (amount > this.userTrxBalance) {
        this.presaleValidationError = '‰ΩôÈ¢ù‰∏çË∂≥';
        return;
      }

      if (amount > this.maxPresaleAmount) {
        this.presaleValidationError = `Ë∂ÖËøáÊúÄÂ§ßÂèØÊäïÂÖ•ÈáëÈ¢ù ${this.maxPresaleAmount.toFixed(2)} TRX`;
        return;
      }

      // Ê£ÄÊü•ÊúÄÂ∞èÊäïÂÖ•ÈôêÂà∂
      // const minBuy = parseFloat(this.tokenInfo.minBuy?.replace(/[^\d.]/g, '') || '1');
      const minBuy = 1; // Âõ∫ÂÆöÊúÄÂ∞èÊäïÂÖ•ÈáëÈ¢ù‰∏∫1 TRX
      if (amount < minBuy) {
        this.presaleValidationError = `ÊúÄÂ∞èÊäïÂÖ•ÈáëÈ¢ù‰∏∫ ${minBuy} TRX`;
        return;
      }
    },

    // ËÆæÁΩÆÊúÄÂ§ßÈáëÈ¢ù
    setMaxAmount() {
      this.presaleAmount = this.maxPresaleAmount.toString();
      this.validatePresaleAmount();
    },

    // Ëé∑ÂèñÁî®Êà∑TRX‰ΩôÈ¢ù
    async getUserTrxBalance() {
      try {
        if (!this.isWalletConnected) {
          this.userTrxBalance = 0;
          return;
        }

        const tronWeb = window.tronWeb;
        if (!tronWeb) {
          throw new Error('TronWeb not available');
        }

        const balance = await tronWeb.trx.getBalance(tronWeb.defaultAddress.base58);
        this.userTrxBalance = tronWeb.fromSun(balance);

      } catch (error) {
        console.error('Failed to get TRX balance:', error);
        this.userTrxBalance = 0;
      }
    },

    // ÂèÇ‰∏éÈ¢ÑÂîÆ
    async enterPresale() {
      if (!this.canEnterPresale) {
        return;
      }

      this.presaleLoading = true;
      this.presaleSuccess = false;

      try {
        // Ê£ÄÊü•Èí±ÂåÖËøûÊé•
        if (!this.isWalletConnected) {
          throw new Error('ËØ∑ÂÖàËøûÊé•Èí±ÂåÖ');
        }

        const tronWeb = window.tronWeb;
        if (!tronWeb) {
          throw new Error('TronWeb not available');
        }

        // È™åËØÅÈáëÈ¢ù
        this.validatePresaleAmount();
        if (this.presaleValidationError) {
          throw new Error(this.presaleValidationError);
        }

        const amount = parseFloat(this.presaleAmount);
        const amountInSun = tronWeb.toSun(amount);

        // Ëé∑ÂèñÈ¢ÑÂîÆÂêàÁ∫¶Âú∞ÂùÄ
        const presaleAddress = await this.getPresaleContractAddress();
        if (!presaleAddress) {
          throw new Error('È¢ÑÂîÆÂêàÁ∫¶Âú∞ÂùÄÊú™ÊâæÂà∞');
        }

        // Ê£ÄÊü•È¢ÑÂîÆÁä∂ÊÄÅ
        await this.checkPresaleStatus(presaleAddress);

        // Ë∞ÉÁî®È¢ÑÂîÆÂêàÁ∫¶
        const contract = await tronWeb.contract(presaleABI, presaleAddress);

        // Ë∞ÉÁî®preSaleÊñπÊ≥ïÂèÇ‰∏éÈ¢ÑÂîÆ
        const result = await contract.preSale().send({
          callValue: amountInSun,
          feeLimit: 100000000 // 100 TRX fee limit
        });

        console.log('Presale transaction result:', result);

        // Á≠âÂæÖ‰∫§ÊòìÁ°ÆËÆ§
        await this.waitForTransaction(result);

        // ÊàêÂäüÂ§ÑÁêÜ
        this.presaleSuccess = true;
        this.$toast('È¢ÑÂîÆÂèÇ‰∏éÊàêÂäüÔºÅ');

        // Êõ¥Êñ∞‰ΩôÈ¢ùÂíåËøõÂ∫¶
        await this.getUserTrxBalance();
        await this.updateFundingProgress();

        // Ê∏ÖÁ©∫ËæìÂÖ•
        setTimeout(() => {
          this.presaleAmount = '';
          this.presaleSuccess = false;
        }, 3000);

      } catch (error) {
        console.error('Presale failed:', error);
        this.$toast(error.message || 'È¢ÑÂîÆÂèÇ‰∏éÂ§±Ë¥•');
      } finally {
        this.presaleLoading = false;
      }
    },

    // Ëé∑ÂèñÈ¢ÑÂîÆÂêàÁ∫¶Âú∞ÂùÄ
    async getPresaleContractAddress() {
      try {
        // Â¶ÇÊûúÂ∑≤ÁªèÁºìÂ≠ò‰∫ÜÂú∞ÂùÄÔºå‰∏î‰∏éÂΩìÂâç‰ª£Â∏Å‰∏ÄËá¥ÔºåÁõ¥Êé•ËøîÂõû
        if (this.presaleContractAddress && this.presaleAddressToken && this.presaleAddressToken === this.tokenInfo.contractAddress) {
          console.log('‚úÖ ‰ΩøÁî®ÁºìÂ≠òÁöÑÈ¢ÑÂîÆÂêàÁ∫¶Âú∞ÂùÄ:', this.presaleContractAddress, 'for token:', this.presaleAddressToken);
          return this.presaleContractAddress;
        }

        console.log('üîç ÂºÄÂßãËé∑ÂèñÈ¢ÑÂîÆÂêàÁ∫¶Âú∞ÂùÄ...');

        // ‰ΩøÁî®Â∑≤ÊúâÁöÑÈ¢ÑÂîÆÂú∞ÂùÄËé∑ÂèñÈÄªËæëÔºà‰∏éloadPresaleInfo‰∏≠ÁöÑÈÄªËæë‰øùÊåÅ‰∏ÄËá¥Ôºâ
        const tokenAddress = this.tokenInfo.contractAddress;
        if (!tokenAddress) {
          throw new Error('‰ª£Â∏ÅÂêàÁ∫¶Âú∞ÂùÄÊú™ÊâæÂà∞');
        }

        // Ë∞ÉÁî®Â∑≤ÊúâÁöÑÈ¢ÑÂîÆÂú∞ÂùÄËé∑ÂèñÊñπÊ≥ï
        const presaleAddress = await this.getPresaleAddressWithFallback(tokenAddress);

        if (!presaleAddress || !this.validateAddress(presaleAddress)) {
          throw new Error('Ëé∑ÂèñÂà∞ÁöÑÈ¢ÑÂîÆÂêàÁ∫¶Âú∞ÂùÄÊó†Êïà');
        }

        // ÁºìÂ≠òÊúâÊïàÁöÑÈ¢ÑÂîÆÂú∞ÂùÄÔºåÂπ∂ÁªëÂÆöÂà∞ÂΩìÂâç‰ª£Â∏Å
        this.presaleContractAddress = presaleAddress;
        this.presaleAddressToken = tokenAddress;
        console.log('‚úÖ È¢ÑÂîÆÂêàÁ∫¶Âú∞ÂùÄËé∑ÂèñÊàêÂäü:', presaleAddress, 'for token:', tokenAddress);

        return presaleAddress;

      } catch (error) {
        console.error('‚ùå Ëé∑ÂèñÈ¢ÑÂîÆÂêàÁ∫¶Âú∞ÂùÄÂ§±Ë¥•:', error);
        throw new Error(`Êó†Ê≥ïËé∑ÂèñÈ¢ÑÂîÆÂêàÁ∫¶Âú∞ÂùÄ: ${error.message}`);
      }
    },

    // Ê£ÄÊü•È¢ÑÂîÆÁä∂ÊÄÅ
    async checkPresaleStatus(presaleAddress) {
      try {
        console.log('üîç Ê£ÄÊü•È¢ÑÂîÆÁä∂ÊÄÅ...');

        // ÂàõÂª∫È¢ÑÂîÆÊúçÂä°ÂÆû‰æã
        const presaleService = new PresaleService(presaleAddress);

        // Ëé∑ÂèñÈ¢ÑÂîÆÁä∂ÊÄÅ
        const presaleStatus = await presaleService.getPresaleStatus();
        console.log('üìä ÂΩìÂâçÈ¢ÑÂîÆÁä∂ÊÄÅ:', presaleStatus);

        // Áä∂ÊÄÅÈ™åËØÅ
        if (presaleStatus === 0) {
          throw new Error('È¢ÑÂîÆÂ∞öÊú™ÂºÄÂßãÔºåËØ∑Á≠âÂæÖÂèëË°åÊñπÂºÄÂêØÈ¢ÑÂîÆ');
        } else if (presaleStatus >= 2) {
          throw new Error('È¢ÑÂîÆÂ∑≤ÁªìÊùüÔºåÊó†Ê≥ïÁªßÁª≠ÂèÇ‰∏é');
        } else if (presaleStatus === 1) {
          console.log('‚úÖ È¢ÑÂîÆËøõË°å‰∏≠ÔºåÂèØ‰ª•ÂèÇ‰∏é');
          return true;
        } else {
          throw new Error(`È¢ÑÂîÆÁä∂ÊÄÅÂºÇÂ∏∏ (${presaleStatus})ÔºåËØ∑ËÅîÁ≥ªÂèëË°åÊñπ`);
        }

      } catch (error) {
        console.error('‚ùå È¢ÑÂîÆÁä∂ÊÄÅÊ£ÄÊü•Â§±Ë¥•:', error);
        throw error;
      }
    },

    // Á≠âÂæÖ‰∫§ÊòìÁ°ÆËÆ§
    async waitForTransaction(txId, timeout = 60000) {
      console.log('‚è≥ ÂºÄÂßãÁ≠âÂæÖ‰∫§ÊòìÁ°ÆËÆ§, TxID:', txId);
      const startTime = Date.now();
      let retryCount = 0;
      const maxRetries = Math.floor(timeout / 2000); // ÊØè2ÁßíÈáçËØï‰∏ÄÊ¨°

      while (Date.now() - startTime < timeout && retryCount < maxRetries) {
        try {
          retryCount++;
          console.log(`üîÑ Á¨¨${retryCount}Ê¨°Êü•ËØ¢‰∫§ÊòìÁä∂ÊÄÅ...`);

          const tronWeb = window.tronWeb;

          // ÂÖàÂ∞ùËØïËé∑Âèñ‰∫§Êòì‰ø°ÊÅØ
          const txInfo = await tronWeb.trx.getTransactionInfo(txId);
          console.log('üìã ‰∫§Êòì‰ø°ÊÅØ:', txInfo);

          // Ê£ÄÊü•‰∫§ÊòìÊòØÂê¶Â∑≤Á°ÆËÆ§
          if (txInfo && txInfo.id) {
            // Êõ¥ÂÆåÂñÑÁöÑÊàêÂäüÂà§Êñ≠ÈÄªËæë
            const isSuccess = this.isTransactionSuccess(txInfo);

            if (isSuccess) {
              console.log('‚úÖ ‰∫§ÊòìÁ°ÆËÆ§ÊàêÂäü!');
              console.log('üìä ‰∫§ÊòìËØ¶ÊÉÖ:', {
                id: txInfo.id,
                blockNumber: txInfo.blockNumber,
                fee: txInfo.fee,
                result: txInfo.result,
                receipt: txInfo.receipt
              });
              return txInfo;
            } else if (this.isTransactionFailed(txInfo)) {
              console.error('‚ùå ‰∫§ÊòìÊâßË°åÂ§±Ë¥•:', txInfo);
              throw new Error(`‰∫§ÊòìÊâßË°åÂ§±Ë¥•: ${this.getFailureReason(txInfo)}`);
            } else {
              console.log('‚è≥ ‰∫§Êòì‰ªçÂú®Â§ÑÁêÜ‰∏≠...');
            }
          } else {
            // Â¶ÇÊûúÊ≤°Êúâ‰∫§Êòì‰ø°ÊÅØÔºåÂ∞ùËØïËé∑Âèñ‰∫§ÊòìËØ¶ÊÉÖ
            try {
              const tx = await tronWeb.trx.getTransaction(txId);
              if (tx && tx.txID) {
                console.log('üìÑ ‰∫§ÊòìÂ∑≤ÂπøÊí≠ÔºåÁ≠âÂæÖÊâìÂåÖÁ°ÆËÆ§...');
              } else {
                console.log('‚ö†Ô∏è ‰∫§ÊòìÂ∞öÊú™ÂπøÊí≠');
              }
            } catch (e) {
              console.log('‚ö†Ô∏è Êó†Ê≥ïËé∑Âèñ‰∫§ÊòìËØ¶ÊÉÖ:', e.message);
            }
          }

          // Á≠âÂæÖ2ÁßíÂêéÈáçËØï
          await new Promise(resolve => setTimeout(resolve, 2000));
        } catch (error) {
          console.warn(`‚ö†Ô∏è Á¨¨${retryCount}Ê¨°Êü•ËØ¢Â§±Ë¥•:`, error.message);

          // Â¶ÇÊûúÊòØÊü•ËØ¢ÈîôËØØÔºåÁªßÁª≠Á≠âÂæÖ
          if (error.message.includes('Transaction not found') ||
              error.message.includes('Invalid transaction id') ||
              error.message.includes('timeout') ||
              error.message.includes('network')) {
            await new Promise(resolve => setTimeout(resolve, 2000));
            continue;
          }

          // ÂÖ∂‰ªñÈîôËØØÁõ¥Êé•ÊäõÂá∫
          throw error;
        }
      }

      // Ë∂ÖÊó∂ÂêéÁªôÂá∫Êõ¥ÂèãÂ•ΩÁöÑÊèêÁ§∫
      console.warn('‚è∞ ‰∫§ÊòìÁ°ÆËÆ§Ë∂ÖÊó∂Ôºå‰ΩÜ‰∫§ÊòìÂèØËÉΩ‰ªçÂú®Â§ÑÁêÜ‰∏≠');
      throw new Error(`‰∫§ÊòìÁ°ÆËÆ§Ë∂ÖÊó∂ÔºåËØ∑Âú®Âå∫ÂùóÈìæÊµèËßàÂô®‰∏≠Êü•Áúã‰∫§ÊòìÁä∂ÊÄÅ: ${txId}`);
    },

    // Âà§Êñ≠‰∫§ÊòìÊòØÂê¶ÊàêÂäü
    isTransactionSuccess(txInfo) {
      // Ê£ÄÊü•Â§öÁßçÊàêÂäüÊù°‰ª∂
      if (!txInfo || !txInfo.id) {
        return false;
      }

      // 1. Ê£ÄÊü• result Â≠óÊÆµÔºàÂ≠óÁ¨¶‰∏≤ÂΩ¢ÂºèÔºâ
      if (txInfo.result === 'SUCCESS') {
        return true;
      }

      // 2. Ê£ÄÊü• receipt ÂØπË±°‰∏≠ÁöÑ result Â≠óÊÆµ
      if (txInfo.receipt && txInfo.receipt.result === 'SUCCESS') {
        return true;
      }

      // 3. Ê£ÄÊü•ÊòØÂê¶Êúâ blockNumberÔºàÂ∑≤ÊâìÂåÖÂà∞Âå∫ÂùóÔºâ‰∏îÊ≤°ÊúâÂ§±Ë¥•Ê†áËÆ∞
      if (txInfo.blockNumber && txInfo.blockNumber > 0) {
        // Â¶ÇÊûúÊúâÂå∫ÂùóÂè∑‰ΩÜÊ≤°ÊúâÊòéÁ°ÆÁöÑÂ§±Ë¥•Ê†áËÆ∞ÔºåÈÄöÂ∏∏Ë°®Á§∫ÊàêÂäü
        if (!txInfo.result || txInfo.result === '' || txInfo.result === 'SUCCESS') {
          return true;
        }

        // Ê£ÄÊü• receipt ‰∏≠ÁöÑÁªìÊûú
        if (txInfo.receipt) {
          if (txInfo.receipt.result === 'SUCCESS' ||
              (txInfo.receipt.result === '' && !txInfo.receipt.revert)) {
            return true;
          }
        }
      }

      // 4. Ê£ÄÊü•Ë¥πÁî®ÊòØÂê¶Â∑≤Êâ£Èô§ÔºàË°®Êòé‰∫§ÊòìÂ∑≤ÊâßË°åÔºâ
      if (txInfo.fee && txInfo.fee > 0 && txInfo.blockNumber) {
        // ÊúâË¥πÁî®‰∏îÊúâÂå∫ÂùóÂè∑ÔºåÊ£ÄÊü•ÊòØÂê¶ÊúâÂ§±Ë¥•Ê†áËÆ∞
        if (!this.hasFailureIndicators(txInfo)) {
          return true;
        }
      }

      return false;
    },

    // Âà§Êñ≠‰∫§ÊòìÊòØÂê¶Â§±Ë¥•
    isTransactionFailed(txInfo) {
      if (!txInfo || !txInfo.id) {
        return false;
      }

      // Ê£ÄÊü•ÊòéÁ°ÆÁöÑÂ§±Ë¥•Ê†áËÆ∞
      if (txInfo.result === 'FAILED' || txInfo.result === 'REVERT') {
        return true;
      }

      if (txInfo.receipt) {
        if (txInfo.receipt.result === 'FAILED' ||
            txInfo.receipt.result === 'REVERT' ||
            txInfo.receipt.revert) {
          return true;
        }
      }

      return false;
    },

    // Ê£ÄÊü•ÊòØÂê¶ÊúâÂ§±Ë¥•ÊåáÁ§∫Âô®
    hasFailureIndicators(txInfo) {
      if (txInfo.result && (txInfo.result === 'FAILED' || txInfo.result === 'REVERT')) {
        return true;
      }

      if (txInfo.receipt && (
          txInfo.receipt.result === 'FAILED' ||
          txInfo.receipt.result === 'REVERT' ||
          txInfo.receipt.revert
      )) {
        return true;
      }

      return false;
    },

    // Ëé∑ÂèñÂ§±Ë¥•ÂéüÂõ†
    getFailureReason(txInfo) {
      if (txInfo.receipt && txInfo.receipt.revert) {
        return 'ÂêàÁ∫¶ÊâßË°åË¢´ÂõûÊªö';
      }

      if (txInfo.result === 'FAILED') {
        return '‰∫§ÊòìÊâßË°åÂ§±Ë¥•';
      }

      if (txInfo.result === 'REVERT') {
        return '‰∫§ÊòìË¢´ÂõûÊªö';
      }

      return 'Êú™Áü•ÈîôËØØ';
    },

    // ==================== ÊéßÂà∂Âè∞È¢ÑÂîÆÁÆ°ÁêÜÂëΩ‰ª§ ====================

    // Ê≥®ÂÜåÊéßÂà∂Âè∞ÂëΩ‰ª§
    registerConsoleCommands() {
      try {
        // Â∞ÜÈ¢ÑÂîÆÁÆ°ÁêÜÊñπÊ≥ïÁªëÂÆöÂà∞ÂÖ®Â±ÄwindowÂØπË±°
        window.presaleAdmin = {
          // Êü•ËØ¢È¢ÑÂîÆÁä∂ÊÄÅ
          getStatus: this.consoleGetPresaleStatus.bind(this),
          // Êü•ËØ¢È¢ÑÂîÆ‰ª∑Ê†º
          getPrice: this.consoleGetPresalePrice.bind(this),
          // Áõ¥Êé•Êü•ËØ¢ preSaleEthAmount
          getPreSaleEthAmount: this.consoleGetPreSaleEthAmount.bind(this),
          // Êü•ËØ¢ËØ¶ÁªÜÈ¢ÑÂîÆ‰ø°ÊÅØ
          getDetailedInfo: this.consoleGetDetailedPresaleInfo.bind(this),
          // Êü•ËØ¢Áî®Êà∑È¢ÑÂîÆËÆ∞ÂΩï
          getUserInfo: this.consoleGetUserPresaleInfo.bind(this),
          // Êü•ËØ¢È¢ÑÂîÆÊÄªËßà
          getTotalInfo: this.consoleGetTotalPresaleInfo.bind(this),
          // Êü•ËØ¢ÊåáÂÆöÂú∞ÂùÄ
          checkAddress: this.consoleCheckAddress.bind(this),
          // ÂºÄÂêØÈ¢ÑÂîÆ
          start: this.consoleStartPresale.bind(this),
          // ÁªìÊùüÈ¢ÑÂîÆ
          end: this.consoleEndPresale.bind(this),
          // Ê£ÄÊü•ÁÆ°ÁêÜÂëòÊùÉÈôê
          checkOwner: this.consoleCheckOwner.bind(this),
          // Â∏ÆÂä©‰ø°ÊÅØ
          help: this.consoleShowHelp.bind(this)
        };

        console.log('üéÆ È¢ÑÂîÆÁÆ°ÁêÜÊéßÂà∂Âè∞Â∑≤ÊøÄÊ¥ªÔºÅ');
        console.log('üìñ ËæìÂÖ• presaleAdmin.help() Êü•ÁúãÂèØÁî®ÂëΩ‰ª§');
        
        // Ê∑ªÂä†ÂÖ®Â±ÄÂø´Êç∑ÂëΩ‰ª§
        window.checkTotal = this.consoleGetTotalPresaleInfo.bind(this);
        window.checkAddress = this.consoleCheckAddress.bind(this);
        console.log('üí° ËæìÂÖ• checkTotal() Âø´ÈÄüÊü•ËØ¢È¢ÑÂîÆÊÄªËßà');
        console.log('üí° ËæìÂÖ• checkAddress("Âú∞ÂùÄ") Êü•ËØ¢ÊåáÂÆöÂú∞ÂùÄÁöÑÈ¢ÑÂîÆ‰ø°ÊÅØ');

      } catch (error) {
        console.error('‚ùå Ê≥®ÂÜåÊéßÂà∂Âè∞ÂëΩ‰ª§Â§±Ë¥•:', error);
      }
    },

    // Ê∏ÖÁêÜÊéßÂà∂Âè∞ÂëΩ‰ª§
    unregisterConsoleCommands() {
      try {
        if (window.presaleAdmin) {
          delete window.presaleAdmin;
          console.log('üßπ È¢ÑÂîÆÁÆ°ÁêÜÊéßÂà∂Âè∞Â∑≤Ê∏ÖÁêÜ');
        }
      } catch (error) {
        console.error('‚ùå Ê∏ÖÁêÜÊéßÂà∂Âè∞ÂëΩ‰ª§Â§±Ë¥•:', error);
      }
    },

    // ÊéßÂà∂Âè∞ÂëΩ‰ª§ÔºöÊòæÁ§∫Â∏ÆÂä©‰ø°ÊÅØ
    consoleShowHelp() {
      console.log(`
üéÆ È¢ÑÂîÆÁÆ°ÁêÜÊéßÂà∂Âè∞ÂëΩ‰ª§Â∏ÆÂä©
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

üìä Êü•ËØ¢ÂëΩ‰ª§Ôºö
  presaleAdmin.getStatus()     - Êü•ËØ¢ÂΩìÂâçÈ¢ÑÂîÆÁä∂ÊÄÅ
  presaleAdmin.getPrice()      - Êü•ËØ¢È¢ÑÂîÆ‰ª∑Ê†º (preSaleEthAmount)
  presaleAdmin.getPreSaleEthAmount() - Áõ¥Êé•Êü•ËØ¢ preSaleEthAmount Â≠òÂÇ®ÂèòÈáè
  presaleAdmin.getDetailedInfo() - Êü•ËØ¢ËØ¶ÁªÜÈ¢ÑÂîÆ‰ø°ÊÅØÂíåÈÖçÁΩÆ
  presaleAdmin.getUserInfo()   - Êü•ËØ¢Áî®Êà∑È¢ÑÂîÆËÆ∞ÂΩï (preSaleAddress mapping)
  presaleAdmin.getTotalInfo()  - Êü•ËØ¢È¢ÑÂîÆÊÄªËßà‰ø°ÊÅØ
  presaleAdmin.checkAddress()  - Êü•ËØ¢ÊåáÂÆöÂú∞ÂùÄÁöÑÈ¢ÑÂîÆ‰ø°ÊÅØ
  presaleAdmin.checkOwner()    - Ê£ÄÊü•ÂΩìÂâçÈí±ÂåÖÊòØÂê¶‰∏∫ÁÆ°ÁêÜÂëò

üéõÔ∏è ÁÆ°ÁêÜÂëΩ‰ª§Ôºà‰ªÖÁÆ°ÁêÜÂëòÔºâÔºö
  presaleAdmin.start()         - ÂºÄÂêØÈ¢ÑÂîÆÔºàËÆæÁΩÆÁä∂ÊÄÅ‰∏∫1Ôºâ
  presaleAdmin.end()           - ÁªìÊùüÈ¢ÑÂîÆÔºàËÆæÁΩÆÁä∂ÊÄÅ‰∏∫2Ôºâ

üìñ ÂÖ∂‰ªñÂëΩ‰ª§Ôºö
  presaleAdmin.help()          - ÊòæÁ§∫Ê≠§Â∏ÆÂä©‰ø°ÊÅØ

üìù Áä∂ÊÄÅËØ¥ÊòéÔºö
  0 = Êú™ÂºÄÂßã    1 = ËøõË°å‰∏≠    2 = Â∑≤ÁªìÊùü

‚ö†Ô∏è Ê≥®ÊÑèÔºöÁÆ°ÁêÜÂëΩ‰ª§ÈúÄË¶ÅÁÆ°ÁêÜÂëòÊùÉÈôê‰∏î‰ºöÊ∂àËÄóTRX‰Ωú‰∏∫ÊâãÁª≠Ë¥π
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      `);
    },

    // ÊéßÂà∂Âè∞ÂëΩ‰ª§ÔºöÊü•ËØ¢È¢ÑÂîÆÁä∂ÊÄÅ
    async consoleGetPresaleStatus() {
      try {
        console.log('üîç Ê≠£Âú®Êü•ËØ¢È¢ÑÂîÆÁä∂ÊÄÅ...');

        const presaleAddress = await this.getPresaleContractAddress();
        if (!presaleAddress) {
          console.error('‚ùå Êó†Ê≥ïËé∑ÂèñÈ¢ÑÂîÆÂêàÁ∫¶Âú∞ÂùÄ');
          return;
        }

        const presaleService = new PresaleService(presaleAddress);
        const status = await presaleService.getPresaleStatus();

        const statusText = presaleService.getPresaleStatusText(status);

        console.log(`
üìä È¢ÑÂîÆÁä∂ÊÄÅÊü•ËØ¢ÁªìÊûú
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üè∑Ô∏è  ÂêàÁ∫¶Âú∞ÂùÄ: ${presaleAddress}
üìà  ÂΩìÂâçÁä∂ÊÄÅ: ${status} (${statusText})
‚è∞  Êü•ËØ¢Êó∂Èó¥: ${new Date().toLocaleString()}
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        `);

        return { status, statusText, contractAddress: presaleAddress };

      } catch (error) {
        console.error('‚ùå Êü•ËØ¢È¢ÑÂîÆÁä∂ÊÄÅÂ§±Ë¥•:', error);
        console.error('üí° ËØ∑Á°Æ‰øùÈí±ÂåÖÂ∑≤ËøûÊé•‰∏îÁΩëÁªúÊ≠£Â∏∏');
      }
    },

    // ÊéßÂà∂Âè∞ÂëΩ‰ª§ÔºöÊü•ËØ¢È¢ÑÂîÆ‰ª∑Ê†º
    async consoleGetPresalePrice() {
      try {
        console.log('üí∞ Ê≠£Âú®Êü•ËØ¢È¢ÑÂîÆ‰ª∑Ê†º...');

        const presaleAddress = await this.getPresaleContractAddress();
        if (!presaleAddress) {
          console.error('‚ùå Êó†Ê≥ïËé∑ÂèñÈ¢ÑÂîÆÂêàÁ∫¶Âú∞ÂùÄ');
          return;
        }

        const presaleService = new PresaleService(presaleAddress);
        
        // Â∞ùËØïÂ§öÁßçÊñπÂºèËé∑ÂèñÈ¢ÑÂîÆ‰ª∑Ê†º
        let priceInfo = null;
        let error = null;
        
        // ÊñπÊ≥ï1ÔºöÂ∞ùËØïË∞ÉÁî® getPresalePriceInfo
        try {
          priceInfo = await presaleService.getPresalePriceInfo();
          console.log('‚úÖ ÈÄöËøá getPresalePriceInfo Ëé∑Âèñ‰ª∑Ê†ºÊàêÂäü');
        } catch (err) {
          console.warn('‚ö†Ô∏è getPresalePriceInfo Ë∞ÉÁî®Â§±Ë¥•ÔºåÂ∞ùËØïÁõ¥Êé•ËØªÂèñÂ≠òÂÇ®ÂèòÈáè');
          error = err;
        }
        
        // ÊñπÊ≥ï2ÔºöÂ¶ÇÊûúÊñπÊ≥ï1Â§±Ë¥•ÔºåÂ∞ùËØïÁõ¥Êé•ËØªÂèñÂ≠òÂÇ®ÂèòÈáè
        if (!priceInfo) {
          try {
            console.log('üîç Â∞ùËØïÁõ¥Êé•ËØªÂèñÈ¢ÑÂîÆ‰ª∑Ê†ºÂ≠òÂÇ®ÂèòÈáè...');
            
            // Áõ¥Êé•Ë∞ÉÁî®ÂêàÁ∫¶ÁöÑ preSaleEthAmount_ Â≠òÂÇ®ÂèòÈáè
            const preSaleEthAmount = await presaleService.callMethod('preSaleEthAmount_');
            const tradeEthAmount = await presaleService.callMethod('tradeEthAmount_');
            const coinAmount = await presaleService.callMethod('coinAmount_');
            
            priceInfo = {
              preSaleEthAmount: preSaleEthAmount,
              tradeEthAmount: tradeEthAmount,
              coinAmount: coinAmount,
              tokenPrice: 'N/A',
              marketCap: 'N/A'
            };
            
            console.log('‚úÖ ÈÄöËøáÁõ¥Êé•ËØªÂèñÂ≠òÂÇ®ÂèòÈáèËé∑Âèñ‰ª∑Ê†ºÊàêÂäü');
          } catch (directErr) {
            console.error('‚ùå Áõ¥Êé•ËØªÂèñÂ≠òÂÇ®ÂèòÈáè‰πüÂ§±Ë¥•:', directErr);
            throw new Error(`Êó†Ê≥ïËé∑ÂèñÈ¢ÑÂîÆ‰ª∑Ê†º‰ø°ÊÅØ„ÄÇÈîôËØØ1: ${error?.message}, ÈîôËØØ2: ${directErr?.message}`);
          }
        }

        // ‰øÆÂ§çÔºöÊ≠£Á°ÆÂ§ÑÁêÜÂçï‰ΩçËΩ¨Êç¢ÂíåBigIntÁ±ªÂûã
        const preSaleEthAmount = priceInfo.preSaleEthAmount;
        const coinAmount = priceInfo.coinAmount;
        
        // Â§ÑÁêÜBigIntÁ±ªÂûãÔºåËΩ¨Êç¢‰∏∫Â≠óÁ¨¶‰∏≤ÂêéÂÜçËΩ¨Êç¢‰∏∫Êï∞Â≠ó
        const preSaleEthAmountNum = typeof preSaleEthAmount === 'bigint' 
          ? parseFloat(preSaleEthAmount.toString()) 
          : parseFloat(preSaleEthAmount);
        const coinAmountNum = typeof coinAmount === 'bigint' 
          ? parseFloat(coinAmount.toString()) 
          : parseFloat(coinAmount);
        
        // ÂêàÁ∫¶‰∏≠Â≠òÂÇ®ÁöÑÊòØSUNÂçï‰ΩçÔºåÈúÄË¶ÅËΩ¨Êç¢‰∏∫TRXÂçï‰Ωç
        const preSaleEthAmountInTrx = preSaleEthAmountNum / 1000000; // SUN -> TRX
        const coinAmountInTrx = coinAmountNum / 1000000; // SUN -> TRX
        
        // ÈáçÊñ∞ÁêÜËß£ÂèòÈáèÂê´‰πâÔºö
        // preSaleEthAmount: È¢ÑÂîÆ‰ª∑Ê†ºÔºà‰ª•SUN‰∏∫Âçï‰ΩçÔºâ
        // coinAmount: ÊÄª‰ª£Â∏ÅÊï∞ÈáèÔºà‰ª•SUN‰∏∫Âçï‰ΩçÔºâ
        // È¢ÑÂîÆ‰ª∑Ê†º = preSaleEthAmountInTrx TRXÔºàÂä®ÊÄÅËé∑ÂèñÔºâ
        // ÊØèTRXÂèØ‰π∞‰ª£Â∏ÅÊï∞Èáè = coinAmountInTrx / preSaleEthAmountInTrx
        
        // Ê†ºÂºèÂåñÊòæÁ§∫
        const preSaleEthAmountFormatted = this.formatTrxAmount(preSaleEthAmount, false, true);
        const coinAmountFormatted = this.formatTrxAmount(coinAmount, false, false);

        // ËÆ°ÁÆóÊØèTRXÂèØ‰π∞Âà∞ÁöÑ‰ª£Â∏ÅÊï∞Èáè
        const tokensPerTrx = coinAmountInTrx / preSaleEthAmountInTrx;
        
        console.log(`
üí∞ È¢ÑÂîÆ‰ª∑Ê†ºÊü•ËØ¢ÁªìÊûú
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üè∑Ô∏è  ÂêàÁ∫¶Âú∞ÂùÄ: ${presaleAddress}
üíé  È¢ÑÂîÆ‰ª∑Ê†º: ${preSaleEthAmountInTrx.toFixed(6)} TRX (Âä®ÊÄÅËé∑Âèñ)
üìä  È¢ÑÂîÆ‰ª∑Ê†º(SUN): ${preSaleEthAmount}
üîÑ  È¢ÑÂîÆ‰ª∑Ê†º(TRX): ${preSaleEthAmountInTrx.toFixed(6)} TRX
ü™ô  ÊÄª‰ª£Â∏ÅÊï∞Èáè(SUN): ${coinAmount}
üîÑ  ÊÄª‰ª£Â∏ÅÊï∞Èáè(TRX): ${coinAmountInTrx.toFixed(6)} ‰∏™
üí±  ÊØèTRXÂèØ‰π∞‰ª£Â∏Å: ${tokensPerTrx.toFixed(2)} ‰∏™
üí±  ÂÆûÈôÖ‰ª£Â∏ÅÊï∞Èáè: ${(coinAmountInTrx / 1000000).toFixed(0)} ‰∏™
üí±  ‰∫§Êòì‰ª∑Ê†º: ${this.formatTrxAmount(priceInfo.tradeEthAmount, false, true)} TRX
‚è∞  Êü•ËØ¢Êó∂Èó¥: ${new Date().toLocaleString()}
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        `);

        return { 
          preSaleEthAmount, 
          preSaleEthAmountFormatted, 
          preSaleEthAmountInTrx,
          coinAmount,
          coinAmountInTrx,
          tokensPerTrx,
          actualTokenAmount: (coinAmountInTrx / 1000000).toFixed(0),
          contractAddress: presaleAddress,
          priceInfo 
        };

      } catch (error) {
        console.error('‚ùå Êü•ËØ¢È¢ÑÂîÆ‰ª∑Ê†ºÂ§±Ë¥•:', error);
        console.error('üí° ËØ∑Á°Æ‰øùÈí±ÂåÖÂ∑≤ËøûÊé•‰∏îÁΩëÁªúÊ≠£Â∏∏');
        console.error('üîç ËØ¶ÁªÜÈîôËØØ‰ø°ÊÅØ:', error.message);
      }
    },

    // ÊéßÂà∂Âè∞ÂëΩ‰ª§ÔºöÁõ¥Êé•Êü•ËØ¢ preSaleEthAmount Â≠òÂÇ®ÂèòÈáè
    async consoleGetPreSaleEthAmount() {
      try {
        console.log('üîç Ê≠£Âú®Áõ¥Êé•Êü•ËØ¢ preSaleEthAmount Â≠òÂÇ®ÂèòÈáè...');

        const presaleAddress = await this.getPresaleContractAddress();
        if (!presaleAddress) {
          console.error('‚ùå Êó†Ê≥ïËé∑ÂèñÈ¢ÑÂîÆÂêàÁ∫¶Âú∞ÂùÄ');
          return;
        }

        const presaleService = new PresaleService(presaleAddress);
        
        // Ë∞ÉÁî® getPoolData ÊñπÊ≥ïËé∑ÂèñÈ¢ÑÂîÆ‰ø°ÊÅØ
        const poolData = await presaleService.callMethod('getPoolData');
        
        // getPoolData ËøîÂõû‰∏Ä‰∏™Êï∞ÁªÑÔºåÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†ÊòØ presaleEthAmount_
        const preSaleEthAmount = poolData[0];
        const tradeEthAmount = poolData[1];
        const maxTotalNum = poolData[2];
        const presaleMaxNum = poolData[3];
        const coinAmount = poolData[4];
        const stageUnlockRate = poolData[5];
        
        const preSaleEthAmountFormatted = this.formatTrxAmount(preSaleEthAmount, false, true);

        console.log(`
üîç preSaleEthAmount Êü•ËØ¢ÁªìÊûú
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üè∑Ô∏è  ÂêàÁ∫¶Âú∞ÂùÄ: ${presaleAddress}
üíé  È¢ÑÂîÆ‰ª∑Ê†º: ${preSaleEthAmountFormatted} TRX
üìä  ÂéüÂßãÊï∞ÂÄº: ${preSaleEthAmount}
  üí±  ‰∫§Êòì‰ª∑Ê†º: ${this.formatTrxAmount(tradeEthAmount, false, true)} TRX
ü™ô  ‰ª£Â∏ÅÊï∞Èáè: ${coinAmount} ‰∏™/TRX
üìà  ÊúÄÂ§ßÊÄªÈáè: ${maxTotalNum}
üéØ  È¢ÑÂîÆÊúÄÂ§ßÊï∞Èáè: ${presaleMaxNum}
üîì  Èò∂ÊÆµËß£ÈîÅÊØî‰æã: ${stageUnlockRate}
‚è∞  Êü•ËØ¢Êó∂Èó¥: ${new Date().toLocaleString()}
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        `);

        return { 
          preSaleEthAmount, 
          preSaleEthAmountFormatted, 
          contractAddress: presaleAddress,
          poolData: {
            preSaleEthAmount,
            tradeEthAmount,
            maxTotalNum,
            presaleMaxNum,
            coinAmount,
            stageUnlockRate
          }
        };

      } catch (error) {
        console.error('‚ùå Êü•ËØ¢ preSaleEthAmount Â§±Ë¥•:', error);
        console.error('üí° ËØ∑Á°Æ‰øùÈí±ÂåÖÂ∑≤ËøûÊé•‰∏îÁΩëÁªúÊ≠£Â∏∏');
        console.error('üîç ËØ¶ÁªÜÈîôËØØ‰ø°ÊÅØ:', error.message);
      }
    },

    // ÊéßÂà∂Âè∞ÂëΩ‰ª§ÔºöÊü•ËØ¢ËØ¶ÁªÜÈ¢ÑÂîÆ‰ø°ÊÅØ
    async consoleGetDetailedPresaleInfo() {
      try {
        console.log('üîç Ê≠£Âú®Êü•ËØ¢ËØ¶ÁªÜÈ¢ÑÂîÆ‰ø°ÊÅØ...');

        const presaleAddress = await this.getPresaleContractAddress();
        if (!presaleAddress) {
          console.error('‚ùå Êó†Ê≥ïËé∑ÂèñÈ¢ÑÂîÆÂêàÁ∫¶Âú∞ÂùÄ');
          return;
        }

        const presaleService = new PresaleService(presaleAddress);
        
        // Ëé∑ÂèñÈ¢ÑÂîÆÁä∂ÊÄÅ
        const status = await presaleService.getPresaleStatus();
        const statusText = presaleService.getPresaleStatusText ? 
          presaleService.getPresaleStatusText(status) : 
          ['Êú™ÂºÄÂßã', 'ËøõË°å‰∏≠', 'Â∑≤ÁªìÊùü', 'Â∑≤ÁªìÊùü', 'Â∑≤ÁªìÊùü'][status] || 'Êú™Áü•Áä∂ÊÄÅ';
        
        // Ëé∑ÂèñÈ¢ÑÂîÆÈÖçÁΩÆ
        const poolData = await presaleService.callMethod('getPoolData');
        const [
          preSaleEthAmount,
          tradeEthAmount,
          maxTotalNum,
          presaleMaxNum,
          coinAmount,
          stageUnlockRate
        ] = poolData;
        
        // Ëé∑ÂèñLGEÈÖçÁΩÆ
        let lgeConfig = null;
        try {
          lgeConfig = await presaleService.callMethod('getLGEConfig');
        } catch (err) {
          console.warn('‚ö†Ô∏è Êó†Ê≥ïËé∑ÂèñLGEÈÖçÁΩÆ:', err.message);
        }
        
        // Ëé∑ÂèñÂêàÁ∫¶‰ΩôÈ¢ù
        let contractBalances = null;
        try {
          contractBalances = await presaleService.callMethod('getContractBalances');
        } catch (err) {
          console.warn('‚ö†Ô∏è Êó†Ê≥ïËé∑ÂèñÂêàÁ∫¶‰ΩôÈ¢ù:', err.message);
        }
        
        // Ëé∑ÂèñÂ∑≤Â§ÑÁêÜÁöÑBNBÊï∞Èáè
        let processedBNB = null;
        try {
          processedBNB = await presaleService.callMethod('processedBNB');
        } catch (err) {
          console.warn('‚ö†Ô∏è Êó†Ê≥ïËé∑ÂèñÂ∑≤Â§ÑÁêÜBNBÊï∞Èáè:', err.message);
        }

        console.log(`
üîç ËØ¶ÁªÜÈ¢ÑÂîÆ‰ø°ÊÅØÊü•ËØ¢ÁªìÊûú
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üè∑Ô∏è  ÂêàÁ∫¶Âú∞ÂùÄ: ${presaleAddress}
üìä  È¢ÑÂîÆÁä∂ÊÄÅ: ${status} (${statusText})

üí∞ ‰ª∑Ê†ºÈÖçÁΩÆ:
  üíé  È¢ÑÂîÆ‰ª∑Ê†º: ${this.formatTrxAmount(preSaleEthAmount, false, true)} TRX
  üí±  ‰∫§Êòì‰ª∑Ê†º: ${this.formatTrxAmount(tradeEthAmount, false, true)} TRX
  ü™ô  ‰ª£Â∏ÅÊï∞Èáè: ${coinAmount} ‰∏™/TRX

üìà Êï∞ÈáèÈÖçÁΩÆ:
  üìä  ÊúÄÂ§ßÊÄªÈáè: ${maxTotalNum}
  üéØ  È¢ÑÂîÆÊúÄÂ§ßÊï∞Èáè: ${presaleMaxNum}
  üîì  Èò∂ÊÆµËß£ÈîÅÊØî‰æã: ${stageUnlockRate}

${lgeConfig ? `
üéØ LGEÈÖçÁΩÆ:
  ‚è∞  ÂºÄÂßãÊó∂Èó¥: ${lgeConfig[5] ? new Date(lgeConfig[5] * 1000).toLocaleString() : 'N/A'}
  üéØ  Á°¨È°∂: ${lgeConfig[6] ? this.formatTrxAmount(lgeConfig[6], true) : 'N/A'} TRX
  üë§  ÊúÄÂ§ßË¥≠‰π∞/Èí±ÂåÖ: ${lgeConfig[7] ? this.formatTrxAmount(lgeConfig[7], true) : 'N/A'} TRX
` : ''}

${contractBalances ? `
üíº ÂêàÁ∫¶‰ΩôÈ¢ù:
  ü™ô  ‰ª£Â∏Å‰ΩôÈ¢ù: ${contractBalances[0] || contractBalances.tokenBalance || 'N/A'}
  üí∞  TRX‰ΩôÈ¢ù: ${contractBalances[1] ? this.formatTrxAmount(contractBalances[1]) : 'N/A'} TRX
` : ''}

${processedBNB ? `
üìä Â∑≤Â§ÑÁêÜBNB: ${this.formatTrxAmount(processedBNB)} TRX
` : ''}

‚è∞  Êü•ËØ¢Êó∂Èó¥: ${new Date().toLocaleString()}
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        `);

        return { 
          status,
          statusText,
          contractAddress: presaleAddress,
          poolData: {
            preSaleEthAmount,
            tradeEthAmount,
            maxTotalNum,
            presaleMaxNum,
            coinAmount,
            stageUnlockRate
          },
          lgeConfig,
          contractBalances,
          processedBNB
        };

      } catch (error) {
        console.error('‚ùå Êü•ËØ¢ËØ¶ÁªÜÈ¢ÑÂîÆ‰ø°ÊÅØÂ§±Ë¥•:', error);
        console.error('üí° ËØ∑Á°Æ‰øùÈí±ÂåÖÂ∑≤ËøûÊé•‰∏îÁΩëÁªúÊ≠£Â∏∏');
        console.error('üîç ËØ¶ÁªÜÈîôËØØ‰ø°ÊÅØ:', error.message);
      }
    },

    // ÊéßÂà∂Âè∞ÂëΩ‰ª§ÔºöÊ£ÄÊü•ÁÆ°ÁêÜÂëòÊùÉÈôê
    async consoleCheckOwner() {
      try {
        console.log('üîê Ê≠£Âú®Ê£ÄÊü•ÁÆ°ÁêÜÂëòÊùÉÈôê...');

        if (!this.isWalletConnected) {
          console.error('‚ùå Èí±ÂåÖÊú™ËøûÊé•ÔºåËØ∑ÂÖàËøûÊé•Èí±ÂåÖ');
          return false;
        }

        const presaleAddress = await this.getPresaleContractAddress();
        if (!presaleAddress) {
          console.error('‚ùå Êó†Ê≥ïËé∑ÂèñÈ¢ÑÂîÆÂêàÁ∫¶Âú∞ÂùÄ');
          return false;
        }

        const presaleService = new PresaleService(presaleAddress);
        const currentAddress = window.tronWeb.defaultAddress.base58;
        const isOwner = await presaleService.isOwner(currentAddress);

        console.log(`
üîê ÁÆ°ÁêÜÂëòÊùÉÈôêÊ£ÄÊü•ÁªìÊûú
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üè∑Ô∏è  ÂêàÁ∫¶Âú∞ÂùÄ: ${presaleAddress}
üë§  ÂΩìÂâçÈí±ÂåÖ: ${currentAddress}
üõ°Ô∏è  ÁÆ°ÁêÜÂëòÊùÉÈôê: ${isOwner ? '‚úÖ ÊòØ' : '‚ùå Âê¶'}
‚è∞  Ê£ÄÊü•Êó∂Èó¥: ${new Date().toLocaleString()}
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        `);

        return isOwner;

      } catch (error) {
        console.error('‚ùå Ê£ÄÊü•ÁÆ°ÁêÜÂëòÊùÉÈôêÂ§±Ë¥•:', error);
        console.error('üí° ËØ∑Á°Æ‰øùÈí±ÂåÖÂ∑≤ËøûÊé•‰∏îÁΩëÁªúÊ≠£Â∏∏');
        return false;
      }
    },

    // ÊéßÂà∂Âè∞ÂëΩ‰ª§ÔºöÊü•ËØ¢Áî®Êà∑È¢ÑÂîÆËÆ∞ÂΩï (preSaleAddress mapping)
    async consoleGetUserPresaleInfo(userAddress = null) {
      try {
        console.log('üîç Ê≠£Âú®Êü•ËØ¢Áî®Êà∑È¢ÑÂîÆËÆ∞ÂΩï...');

        if (!this.isWalletConnected) {
          console.error('‚ùå Èí±ÂåÖÊú™ËøûÊé•ÔºåËØ∑ÂÖàËøûÊé•Èí±ÂåÖ');
          return null;
        }

        const presaleAddress = await this.getPresaleContractAddress();
        if (!presaleAddress) {
          console.error('‚ùå Êó†Ê≥ïËé∑ÂèñÈ¢ÑÂîÆÂêàÁ∫¶Âú∞ÂùÄ');
          return null;
        }

        // Â¶ÇÊûúÊ≤°ÊúâÊåáÂÆöÁî®Êà∑Âú∞ÂùÄÔºå‰ΩøÁî®ÂΩìÂâçËøûÊé•ÁöÑÈí±ÂåÖÂú∞ÂùÄ
        const targetAddress = userAddress || window.tronWeb.defaultAddress.base58;
        console.log(`üë§ Êü•ËØ¢Âú∞ÂùÄ: ${targetAddress}`);

        const presaleService = new PresaleService(presaleAddress);
        
        // Áõ¥Êé•Ë∞ÉÁî®ÂêàÁ∫¶ÁöÑ preSaleAddress mapping
        const result = await presaleService.callMethod('preSaleAddress', [targetAddress]);
        
        // Ëß£ÊûêËøîÂõûÁªìÊûú
        const userInfo = {
          user: result.user || result[0],
          preSaleCount: result.preSaleCount || result[1],
          hasUnlockAmount: result.hasUnlockAmount || result[2],
          stage: result.stage || result[3],
          verify: result.verify || result[4]
        };

        if (userInfo.preSaleCount > 0) {
          console.log(`
‚úÖ ÊâæÂà∞È¢ÑÂîÆËÆ∞ÂΩïÔºÅ
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üè∑Ô∏è  ÂêàÁ∫¶Âú∞ÂùÄ: ${presaleAddress}
üë§  Áî®Êà∑Âú∞ÂùÄ: ${targetAddress}
üí∞  È¢ÑÂîÆÊï∞Èáè: ${userInfo.preSaleCount}
üîì  Â∑≤Ëß£ÈîÅÊï∞Èáè: ${userInfo.hasUnlockAmount}
üìä  ÂΩìÂâçÈò∂ÊÆµ: ${userInfo.stage}
‚úÖ  È™åËØÅÁä∂ÊÄÅ: ${userInfo.verify ? 'Â∑≤È™åËØÅ' : 'Êú™È™åËØÅ'}
‚è∞  Êü•ËØ¢Êó∂Èó¥: ${new Date().toLocaleString()}
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
          `);
        } else {
          console.log(`
‚ùå Êú™ÊâæÂà∞È¢ÑÂîÆËÆ∞ÂΩï
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üè∑Ô∏è  ÂêàÁ∫¶Âú∞ÂùÄ: ${presaleAddress}
üë§  Áî®Êà∑Âú∞ÂùÄ: ${targetAddress}
üí°  ËØ•Âú∞ÂùÄÊú™ÂèÇ‰∏éÈ¢ÑÂîÆÊàñÈ¢ÑÂîÆÊï∞Èáè‰∏∫0
‚è∞  Êü•ËØ¢Êó∂Èó¥: ${new Date().toLocaleString()}
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
          `);
        }

        return userInfo;

              } catch (error) {
          console.error('‚ùå Êü•ËØ¢Áî®Êà∑È¢ÑÂîÆËÆ∞ÂΩïÂ§±Ë¥•:', error);
          console.error('üí° ËØ∑Á°Æ‰øùÈí±ÂåÖÂ∑≤ËøûÊé•‰∏îÁΩëÁªúÊ≠£Â∏∏');
          return null;
        }
      },

      // ÊéßÂà∂Âè∞ÂëΩ‰ª§ÔºöÊü•ËØ¢È¢ÑÂîÆÊÄªËßà‰ø°ÊÅØ
      async consoleGetTotalPresaleInfo() {
        try {
          console.log('üìä Ê≠£Âú®Êü•ËØ¢È¢ÑÂîÆÊÄªËßà‰ø°ÊÅØ...');

          if (!this.isWalletConnected) {
            console.error('‚ùå Èí±ÂåÖÊú™ËøûÊé•ÔºåËØ∑ÂÖàËøûÊé•Èí±ÂåÖ');
            return null;
          }

          const presaleAddress = await this.getPresaleContractAddress();
          if (!presaleAddress) {
            console.error('‚ùå Êó†Ê≥ïËé∑ÂèñÈ¢ÑÂîÆÂêàÁ∫¶Âú∞ÂùÄ');
            return null;
          }

          const presaleService = new PresaleService(presaleAddress);
          
          // Ëé∑ÂèñÈ¢ÑÂîÆÁõ∏ÂÖ≥ÁöÑÊÄªÈáè‰ø°ÊÅØ
          const [
            totalPresaleBNB,      // È¢ÑÂîÆÈò∂ÊÆµÁ¥ØÁßØÁöÑBNB
            accumulatedBNB,       // Á¥ØÁßØÁöÑBNBÊÄªÈáè
            processedBNB,         // Â∑≤Â§ÑÁêÜÁöÑBNBÊï∞Èáè
            presaleStatus,        // È¢ÑÂîÆÁä∂ÊÄÅ
            startTime,            // È¢ÑÂîÆÂºÄÂßãÊó∂Èó¥
            hardcap               // Á°¨È°∂ÈôêÂà∂
          ] = await Promise.all([
            presaleService.callMethod('totalPresaleBNB'),
            presaleService.callMethod('accumulatedBNB'),
            presaleService.callMethod('processedBNB'),
            presaleService.callMethod('presaleStatus'),
            presaleService.callMethod('startTime'),
            presaleService.callMethod('hardcap')
          ]);

          // Ê†ºÂºèÂåñBNBÈáëÈ¢ùÔºà‰ªéSunÂçï‰ΩçËΩ¨Êç¢‰∏∫TRXÔºâ
          const formatBNB = (amount) => {
            if (!amount) return '0';
            const bnbAmount = Number(amount) / 1e6; // TRON‰ΩøÁî®6‰ΩçÂ∞èÊï∞
            return bnbAmount.toFixed(6);
          };

          // Ê†ºÂºèÂåñÊó∂Èó¥
          const formatTime = (timestamp) => {
            if (!timestamp || timestamp === '0') return 'N/A';
            const date = new Date(Number(timestamp));
            return date.toLocaleString();
          };

          // Ëé∑ÂèñÁä∂ÊÄÅÊñáÊú¨
          const getStatusText = (status) => {
            switch (status) {
              case '0': return 'Êú™ÂºÄÂßã';
              case '1': return 'ËøõË°å‰∏≠';
              case '2': return 'Â∑≤ÁªìÊùü';
              default: return 'Êú™Áü•Áä∂ÊÄÅ';
            }
          };

          console.log(`
üìä È¢ÑÂîÆÊÄªËßà‰ø°ÊÅØ
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üè∑Ô∏è  ÂêàÁ∫¶Âú∞ÂùÄ: ${presaleAddress}
üìà  ÂΩìÂâçÁä∂ÊÄÅ: ${presaleStatus} (${getStatusText(presaleStatus)})
üí∞  È¢ÑÂîÆÊÄªÈáëÈ¢ù: ${formatBNB(totalPresaleBNB)} TRX
üíé  Á¥ØÁßØÊÄªÈáëÈ¢ù: ${formatBNB(accumulatedBNB)} TRX
üîÑ  Â∑≤Â§ÑÁêÜÈáëÈ¢ù: ${formatBNB(processedBNB)} TRX
üéØ  Á°¨È°∂ÈôêÂà∂: ${formatBNB(hardcap)} TRX
‚è∞  ÂºÄÂßãÊó∂Èó¥: ${formatTime(startTime)}
‚è∞  Êü•ËØ¢Êó∂Èó¥: ${new Date().toLocaleString()}
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
          `);

          return {
            presaleAddress,
            presaleStatus,
            totalPresaleBNB: formatBNB(totalPresaleBNB),
            accumulatedBNB: formatBNB(accumulatedBNB),
            processedBNB: formatBNB(processedBNB),
            hardcap: formatBNB(hardcap),
            startTime: formatTime(startTime)
          };

        } catch (error) {
          console.error('‚ùå Êü•ËØ¢È¢ÑÂîÆÊÄªËßà‰ø°ÊÅØÂ§±Ë¥•:', error);
          console.error('üí° ËØ∑Á°Æ‰øùÈí±ÂåÖÂ∑≤ËøûÊé•‰∏îÁΩëÁªúÊ≠£Â∏∏');
          return null;
        }
      },

      // ÊéßÂà∂Âè∞ÂëΩ‰ª§ÔºöÊü•ËØ¢ÊåáÂÆöÂú∞ÂùÄÁöÑÈ¢ÑÂîÆ‰ø°ÊÅØ
      async consoleCheckAddress(address = null) {
        try {
          if (!address) {
            console.error('‚ùå ËØ∑Êèê‰æõË¶ÅÊü•ËØ¢ÁöÑÂú∞ÂùÄ');
            console.log('üí° ‰ΩøÁî®ÊñπÊ≥ï: checkAddress("Âú∞ÂùÄ")');
            console.log('üí° ‰æãÂ¶Ç: checkAddress("TK57586sko7cTQxgNUGqpzMGWTwWBsr6iu")');
            return null;
          }

          console.log(`üîç Ê≠£Âú®Êü•ËØ¢Âú∞ÂùÄ ${address} ÁöÑÈ¢ÑÂîÆ‰ø°ÊÅØ...`);

          if (!this.isWalletConnected) {
            console.error('‚ùå Èí±ÂåÖÊú™ËøûÊé•ÔºåËØ∑ÂÖàËøûÊé•Èí±ÂåÖ');
            return null;
          }

          const presaleAddress = await this.getPresaleContractAddress();
          if (!presaleAddress) {
            console.error('‚ùå Êó†Ê≥ïËé∑ÂèñÈ¢ÑÂîÆÂêàÁ∫¶Âú∞ÂùÄ');
            return null;
          }

          const presaleService = new PresaleService(presaleAddress);
          
          // Ëé∑ÂèñËØ•Âú∞ÂùÄÁöÑÈ¢ÑÂîÆ‰ø°ÊÅØ
          const presaleInfo = await presaleService.callMethod('preSaleAddress', [address]);

          // Ëß£ÊûêËøîÂõûÁªìÊûú
          const userInfo = {
            user: presaleInfo.user || presaleInfo[0],
            preSaleCount: presaleInfo.preSaleCount || presaleInfo[1],
            hasUnlockAmount: presaleInfo.hasUnlockAmount || presaleInfo[2],
            stage: presaleInfo.stage || presaleInfo[3],
            verify: presaleInfo.verify || presaleInfo[4]
          };

          if (userInfo.preSaleCount > 0) {
            console.log(`
‚úÖ ÊâæÂà∞È¢ÑÂîÆËÆ∞ÂΩïÔºÅ
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üè∑Ô∏è  ÂêàÁ∫¶Âú∞ÂùÄ: ${presaleAddress}
üë§  Êü•ËØ¢Âú∞ÂùÄ: ${address}
üí∞  È¢ÑÂîÆÊï∞Èáè: ${userInfo.preSaleCount}
üîì  Â∑≤Ëß£ÈîÅÊï∞Èáè: ${userInfo.hasUnlockAmount}
üìä  ÂΩìÂâçÈò∂ÊÆµ: ${userInfo.stage}
‚úÖ  È™åËØÅÁä∂ÊÄÅ: ${userInfo.verify ? 'Â∑≤È™åËØÅ' : 'Êú™È™åËØÅ'}
‚è∞  Êü•ËØ¢Êó∂Èó¥: ${new Date().toLocaleString()}
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
            `);
          } else {
            console.log(`
‚ùå Êú™ÊâæÂà∞È¢ÑÂîÆËÆ∞ÂΩï
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üè∑Ô∏è  ÂêàÁ∫¶Âú∞ÂùÄ: ${presaleAddress}
üë§  Êü•ËØ¢Âú∞ÂùÄ: ${address}
üí°  ËØ•Âú∞ÂùÄÊú™ÂèÇ‰∏éÈ¢ÑÂîÆÊàñÈ¢ÑÂîÆÊï∞Èáè‰∏∫0
‚è∞  Êü•ËØ¢Êó∂Èó¥: ${new Date().toLocaleString()}
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
            `);
          }

          return userInfo;

        } catch (error) {
          console.error('‚ùå Êü•ËØ¢Âú∞ÂùÄÈ¢ÑÂîÆ‰ø°ÊÅØÂ§±Ë¥•:', error);
          console.error('üí° ËØ∑Á°Æ‰øùÈí±ÂåÖÂ∑≤ËøûÊé•‰∏îÁΩëÁªúÊ≠£Â∏∏');
          return null;
        }
      },

    // ÊéßÂà∂Âè∞ÂëΩ‰ª§ÔºöÂºÄÂêØÈ¢ÑÂîÆ
    async consoleStartPresale() {
      try {
        console.log('üöÄ Ê≠£Âú®ÂºÄÂêØÈ¢ÑÂîÆ...');

        // Ê£ÄÊü•ÊùÉÈôê
        const isOwner = await this.consoleCheckOwner();
        if (!isOwner) {
          console.error('‚ùå ÊùÉÈôê‰∏çË∂≥ÔºöÂè™ÊúâÂêàÁ∫¶ÁÆ°ÁêÜÂëòÊâçËÉΩÂºÄÂêØÈ¢ÑÂîÆ');
          return false;
        }

        const presaleAddress = await this.getPresaleContractAddress();
        const presaleService = new PresaleService(presaleAddress);

        // Ê£ÄÊü•ÂΩìÂâçÁä∂ÊÄÅ
        const currentStatus = await presaleService.getPresaleStatus();
        if (currentStatus === 1) {
          console.warn('‚ö†Ô∏è È¢ÑÂîÆÂ∑≤ÁªèÂú®ËøõË°å‰∏≠ÔºåÊó†ÈúÄÈáçÂ§çÂºÄÂêØ');
          return false;
        }

        console.log('üìù Ê≠£Âú®Êèê‰∫§ÂºÄÂêØÈ¢ÑÂîÆ‰∫§Êòì...');
        const result = await presaleService.startPresale();

        console.log(`
üöÄ È¢ÑÂîÆÂºÄÂêØÊàêÂäüÔºÅ
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üè∑Ô∏è  ÂêàÁ∫¶Âú∞ÂùÄ: ${presaleAddress}
üìà  Êñ∞Áä∂ÊÄÅ: 1 (ËøõË°å‰∏≠)
üîó  ‰∫§ÊòìÂìàÂ∏å: ${result}
‚è∞  Êìç‰ΩúÊó∂Èó¥: ${new Date().toLocaleString()}
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        `);

        // Âà∑Êñ∞È°µÈù¢Êï∞ÊçÆ
        setTimeout(() => {
          this.loadPresaleInfo();
        }, 3000);

        return true;

      } catch (error) {
        console.error('‚ùå ÂºÄÂêØÈ¢ÑÂîÆÂ§±Ë¥•:', error);
        console.error('üí° ËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•ÂíåTRX‰ΩôÈ¢ù');
        return false;
      }
    },

    // ÊéßÂà∂Âè∞ÂëΩ‰ª§ÔºöÁªìÊùüÈ¢ÑÂîÆ
    async consoleEndPresale() {
      try {
        console.log('üõë Ê≠£Âú®ÁªìÊùüÈ¢ÑÂîÆ...');

        // Ê£ÄÊü•ÊùÉÈôê
        const isOwner = await this.consoleCheckOwner();
        if (!isOwner) {
          console.error('‚ùå ÊùÉÈôê‰∏çË∂≥ÔºöÂè™ÊúâÂêàÁ∫¶ÁÆ°ÁêÜÂëòÊâçËÉΩÁªìÊùüÈ¢ÑÂîÆ');
          return false;
        }

        const presaleAddress = await this.getPresaleContractAddress();
        const presaleService = new PresaleService(presaleAddress);

        // Ê£ÄÊü•ÂΩìÂâçÁä∂ÊÄÅ
        const currentStatus = await presaleService.getPresaleStatus();
        if (currentStatus >= 2) {
          console.warn('‚ö†Ô∏è È¢ÑÂîÆÂ∑≤ÁªèÁªìÊùüÔºåÊó†ÈúÄÈáçÂ§çÊìç‰Ωú');
          return false;
        }

        console.log('üìù Ê≠£Âú®Êèê‰∫§ÁªìÊùüÈ¢ÑÂîÆ‰∫§Êòì...');
        const result = await presaleService.endPresale();

        console.log(`
üõë È¢ÑÂîÆÁªìÊùüÊàêÂäüÔºÅ
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
üè∑Ô∏è  ÂêàÁ∫¶Âú∞ÂùÄ: ${presaleAddress}
üìà  Êñ∞Áä∂ÊÄÅ: 2 (Â∑≤ÁªìÊùü)
üîó  ‰∫§ÊòìÂìàÂ∏å: ${result}
‚è∞  Êìç‰ΩúÊó∂Èó¥: ${new Date().toLocaleString()}
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        `);

        // Âà∑Êñ∞È°µÈù¢Êï∞ÊçÆ
        setTimeout(() => {
          this.loadPresaleInfo();
        }, 3000);

        return true;

      } catch (error) {
        console.error('‚ùå ÁªìÊùüÈ¢ÑÂîÆÂ§±Ë¥•:', error);
        console.error('üí° ËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•ÂíåTRX‰ΩôÈ¢ù');
        return false;
      }
    },

    // Êõ¥Êñ∞ËµÑÈáëËøõÂ∫¶
    async updateFundingProgress() {
      try {
        const presaleAddress = await this.getPresaleContractAddress();
        if (!presaleAddress) return;

        const tronWeb = window.tronWeb;
        const contract = await tronWeb.contract(presaleABI, presaleAddress);

        // Ëé∑ÂèñÊÄªÁ≠πÈõÜÈáëÈ¢ù
        const totalRaised = await contract.totalPresaleBNB().call();
        const hardCap = parseFloat(this.tokenInfo.hardCap?.replace(/[^\d.]/g, '') || '1000');

        // Êõ¥Êñ∞ËøõÂ∫¶ÁôæÂàÜÊØî
        const raisedInTrx = tronWeb.fromSun(totalRaised);
        this.fundingPercentage = Math.min((raisedInTrx / hardCap) * 100, 100);

      } catch (error) {
        console.error('Failed to update funding progress:', error);
      }
    },

    // ÁõëÂê¨Èí±ÂåÖËøûÊé•Áä∂ÊÄÅ
    watchWalletConnection() {
      // ÂàùÂßãÊ£ÄÊü•
      this.checkWalletConnection();

      // ÂÆöÊúüÊ£ÄÊü•Èí±ÂåÖËøûÊé•Áä∂ÊÄÅ
      this.walletWatcher = setInterval(() => {
        this.checkWalletConnection();
      }, 2000);
    },

    // Ê£ÄÊü•Èí±ÂåÖËøûÊé•Áä∂ÊÄÅ
    async checkWalletConnection() {
      const wasConnected = this.isWalletConnected;
      const isNowConnected = !!(window.tronWeb && window.tronWeb.defaultAddress?.base58);

      if (!wasConnected && isNowConnected) {
        // Èí±ÂåÖÂàöËøûÊé•ÔºåÊõ¥Êñ∞‰ΩôÈ¢ù
        await this.getUserTrxBalance();
      } else if (wasConnected && !isNowConnected) {
        // Èí±ÂåÖÊñ≠ÂºÄËøûÊé•ÔºåÈáçÁΩÆ‰ΩôÈ¢ù
        this.userTrxBalance = 0;
        this.presaleAmount = '';
        this.presaleValidationError = '';
      }
    },

    // ÂáèÂ∞ëÂÜÖÁõòÊï∞Èáè
    decreaseInternalAmount() {
      if (this.internalMarketAmount > 100) {
        this.internalMarketAmount -= 100;
      }
    },

    // Â¢ûÂä†ÂÜÖÁõòÊï∞Èáè
    increaseInternalAmount() {
      if (this.internalMarketAmount < this.trxBalance) {
        this.internalMarketAmount += 100;
      }
    },

    // ÂÜÖÁõòË¥≠‰π∞
    async buyInternalMarket() {
      if (this.internalMarketQuota <= 0) {
        this.$toast('ÂÜÖÁõòÈ¢ùÂ∫¶‰∏çË∂≥');
        return;
      }

      console.log('ÂÜÖÁõòË¥≠‰π∞:', this.internalMarketAmount);
      this.$toast('ÂÜÖÁõòË¥≠‰π∞ËØ∑Ê±ÇÂ∑≤Êèê‰∫§');

      setTimeout(() => {
        this.internalMarketQuota--;
        this.$toast('ÂÜÖÁõòË¥≠‰π∞ÊàêÂäüÔºÅ');
      }, 2000);
    },

    // ËÆæÁΩÆÊúÄÂ§ßÊï∞Èáè
    setMaxAmount() {
      if (this.buySellTab === 'buy') {
        this.inputAmount = this.trxBalance.toString();
      } else {
        this.inputAmount = '1000000';
      }
    },

    // Â§ÑÁêÜ‰π∞ÂçñÊìç‰Ωú
    async handleBuySell() {
      if (!this.inputAmount || parseFloat(this.inputAmount) <= 0) {
        this.$toast('ËØ∑ËæìÂÖ•ÊúâÊïàÊï∞Èáè');
        return;
      }

      try {
        if (this.buySellTab === 'buy') {
          await this.handleBuy();
        } else {
          await this.handleSell();
        }
      } catch (error) {
        console.error('‰∫§ÊòìÂ§±Ë¥•:', error);
        this.$toast('‰∫§ÊòìÂ§±Ë¥•ÔºåËØ∑ÈáçËØï');
      }
    },

    // Â§ÑÁêÜË¥≠‰π∞
    async handleBuy() {
      const amount = parseFloat(this.inputAmount);
      if (amount > this.trxBalance) {
        this.$toast('‰ΩôÈ¢ù‰∏çË∂≥');
        return;
      }

      console.log('Ë¥≠‰π∞Êï∞Èáè:', amount);
      this.$toast('Ë¥≠‰π∞ËØ∑Ê±ÇÂ∑≤Êèê‰∫§');

      setTimeout(() => {
        this.inputAmount = '';
        this.$toast('Ë¥≠‰π∞ÊàêÂäüÔºÅ');
      }, 2000);
    },

    // Â§ÑÁêÜÂçñÂá∫
    async handleSell() {
      const amount = parseFloat(this.inputAmount);

      console.log('ÂçñÂá∫Êï∞Èáè:', amount);
      this.$toast('ÂçñÂá∫ËØ∑Ê±ÇÂ∑≤Êèê‰∫§');

      setTimeout(() => {
        this.inputAmount = '';
        this.$toast('ÂçñÂá∫ÊàêÂäüÔºÅ');
      }, 2000);
    },

    // È¢ÜÂèñLP
    async claimLp() {
      try {
        console.log('È¢ÜÂèñLP');
        this.$toast('È¢ÜÂèñËØ∑Ê±ÇÂ∑≤Êèê‰∫§');

        setTimeout(() => {
          this.$toast('È¢ÜÂèñÊàêÂäüÔºÅ');
        }, 2000);
      } catch (error) {
        console.error('È¢ÜÂèñÂ§±Ë¥•:', error);
        this.$toast('È¢ÜÂèñÂ§±Ë¥•ÔºåËØ∑ÈáçËØï');
      }
    },

    // Êõ¥Êñ∞ÂÄíËÆ°Êó∂
    updateCountdown() {
      console.log('ÂÄíËÆ°Êó∂Êõ¥Êñ∞');
    },

    // ==================== Êï∞ÊçÆÊ†ºÂºèÂåñÂ∑•ÂÖ∑ÊñπÊ≥ï ====================

    // Ê†ºÂºèÂåñÊó∂Èó¥Êà≥
    formatTimestamp(timestamp) {
      if (!timestamp) return '2025/08/15 14:14(4d 2h)'

      try {
        const date = new Date(parseInt(timestamp) * 1000)
        const now = new Date()
        const diffMs = date.getTime() - now.getTime()
        const diffDays = Math.ceil(diffMs / (1000 * 60 * 60 * 24))
        const diffHours = Math.ceil((diffMs % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60))

        const dateStr = date.toLocaleDateString('zh-CN').replace(/\//g, '/')
        const timeStr = date.toLocaleTimeString('zh-CN', { hour12: false, hour: '2-digit', minute: '2-digit' })
        const relativeStr = diffMs > 0 ? `(${diffDays}d ${diffHours}h)` : '(Â∑≤ÂºÄÂßã)'

        return `${dateStr} ${timeStr}${relativeStr}`
      } catch (error) {
        console.error('Êó∂Èó¥Ê†ºÂºèÂåñÂ§±Ë¥•:', error)
        return '2025/08/15 14:14(4d 2h)'
      }
    },

    // Ê†ºÂºèÂåñÊåÅÁª≠Êó∂Èó¥
    formatDuration(seconds) {
      if (!seconds) return '90 days'

      try {
        const days = Math.floor(parseInt(seconds) / (24 * 60 * 60))
        return `${days} days`
      } catch (error) {
        return '10 days'
      }
    },

    // Ê†ºÂºèÂåñ TRX ÈáëÈ¢ù - ‰øÆÂ§çÔºöÊ≠£Á°ÆÂ§ÑÁêÜSUNÂà∞TRXËΩ¨Êç¢ÔºåÈÅøÂÖç‰∫åÊ¨°Ê†ºÂºèÂåñ
    formatTrxAmount(amount, isHardCapOrMaxBuy = false, isPresalePrice = false) {
      if (!amount) return '0 TRX'

      try {
        // Â§ÑÁêÜBigIntÁ±ªÂûã
        let numericAmount = amount
        if (typeof amount === 'bigint') {
          numericAmount = amount.toString()
        }

        // ËΩ¨Êç¢‰∏∫Êï∞Â≠ó
        let trxAmount = parseFloat(numericAmount)
        
        // Ê∑ªÂä†ËØ¶ÁªÜÁöÑË∞ÉËØïÊó•Âøó
        console.log(`üîç formatTrxAmount ËæìÂÖ•ËØ¶ÊÉÖ:`, {
          ÂéüÂßãËæìÂÖ•: amount,
          ËΩ¨Êç¢ÂêéÊï∞ÂÄº: trxAmount,
          ËæìÂÖ•Á±ªÂûã: typeof amount,
          ÊòØÂê¶Á°¨È°∂ÊàñÊúÄÂ§ßË¥≠‰π∞Èáè: isHardCapOrMaxBuy,
          ÊòØÂê¶È¢ÑÂîÆ‰ª∑Ê†º: isPresalePrice
        })
        
        // Â¶ÇÊûúÊòØÈ¢ÑÂîÆ‰ª∑Ê†ºÔºå‰∏îÊï∞ÂÄºÂºÇÂ∏∏Â§ßÔºåÂèØËÉΩÈúÄË¶ÅÁâπÊÆäÂ§ÑÁêÜ
        if (isPresalePrice && trxAmount > 1e15) {
          console.log(`üîß Ê£ÄÊµãÂà∞È¢ÑÂîÆ‰ª∑Ê†ºÂºÇÂ∏∏Â§ßÊï∞ÂÄº: ${trxAmount}ÔºåÂ∞ùËØïÊô∫ËÉΩÂçï‰ΩçËΩ¨Êç¢`)
          // È¢ÑÂîÆ‰ª∑Ê†ºÂèØËÉΩÊòØweiÂçï‰ΩçÔºåÈúÄË¶ÅÈô§‰ª•1e18
          if (trxAmount > 1e18) {
            console.log(`üîÑ È¢ÑÂîÆ‰ª∑Ê†ºÂ∫îÁî®weiÂà∞etherËΩ¨Êç¢: ${trxAmount} / 1e18`)
            trxAmount = trxAmount / 1e18
          } else if (trxAmount > 1e12) {
            console.log(`üîÑ È¢ÑÂîÆ‰ª∑Ê†ºÂ∫îÁî®sunÂà∞trxËΩ¨Êç¢: ${trxAmount} / 1e6`)
            trxAmount = trxAmount / 1e6
          }
        }
        // Â¶ÇÊûúÊòØÁ°¨È°∂ÊàñÊúÄÂ§ßË¥≠‰π∞ÈáèÔºå‰∏îÊï∞ÂÄºÂºÇÂ∏∏Â§ßÔºåÈúÄË¶ÅÈ¢ùÂ§ñÈô§‰ª•10^6
        else if (isHardCapOrMaxBuy && trxAmount > 1000000000000) { // ÊèêÈ´òÈòàÂÄºÂà∞1‰∏á‰∫ø
          console.log(`üîß Ê£ÄÊµãÂà∞Á°¨È°∂/ÊúÄÂ§ßË¥≠‰π∞ÈáèÂºÇÂ∏∏Â§ßÊï∞ÂÄº: ${trxAmount}ÔºåÂ∫îÁî®È¢ùÂ§ñÂçï‰ΩçËΩ¨Êç¢`)
          // Ê£ÄÊü•ÊòØÂê¶Â∑≤ÁªèÊòØTRXÂçï‰ΩçÔºàÈÄöËøáÊ£ÄÊü•Êï∞ÂÄºËåÉÂõ¥Ôºâ
          if (trxAmount > 1e18) { // Â¶ÇÊûúË∂ÖËøá1e18ÔºåÂèØËÉΩÊòØweiÂçï‰ΩçÔºåÈúÄË¶ÅÈô§‰ª•1e18
            console.log(`üîÑ Ê£ÄÊµãÂà∞ÂèØËÉΩÊòØweiÂçï‰ΩçÔºåÂ∫îÁî®weiÂà∞etherËΩ¨Êç¢`)
            trxAmount = trxAmount / 1e18
          } else if (trxAmount > 1e6) { // Â¶ÇÊûúË∂ÖËøá1e6ÔºåÂèØËÉΩÊòØsunÂçï‰ΩçÔºåÈúÄË¶ÅÈô§‰ª•1e6
            console.log(`üîÑ Ê£ÄÊµãÂà∞ÂèØËÉΩÊòØsunÂçï‰ΩçÔºåÂ∫îÁî®sunÂà∞trxËΩ¨Êç¢`)
            trxAmount = trxAmount / 1e6
          } else {
            // ÂÖ∂‰ªñÊÉÖÂÜµÔºåÂ∫îÁî®È¢ùÂ§ñÁöÑ10^6ËΩ¨Êç¢
            trxAmount = trxAmount / 1000000
          }
        } else {
          // ÊôÆÈÄöÊÉÖÂÜµÔºöÂ§ÑÁêÜSUNÂà∞TRXÁöÑËΩ¨Êç¢
          trxAmount = trxAmount / 1000000 // ËΩ¨Êç¢ SUN Âà∞ TRX
        }
        
        // Ê∑ªÂä†Êõ¥ËØ¶ÁªÜÁöÑË∞ÉËØï‰ø°ÊÅØ
        if (isHardCapOrMaxBuy) {
          console.log(`üîç Á°¨È°∂/ÊúÄÂ§ßË¥≠‰π∞ÈáèÂ§ÑÁêÜËØ¶ÊÉÖ:`, {
            ÂéüÂßãÊï∞ÂÄº: numericAmount,
            ËΩ¨Êç¢ÂêéÊï∞ÂÄº: trxAmount,
            ÊòØÂê¶Â∫îÁî®È¢ùÂ§ñËΩ¨Êç¢: trxAmount > 1000000000000,
            ÊúÄÁªàÊï∞ÂÄº: trxAmount
          })
        }

        // Ê∑ªÂä†ËØ¶ÁªÜË∞ÉËØïÊó•Âøó
        console.log(`üí∞ TRXÈáëÈ¢ùËΩ¨Êç¢ËØ¶ÊÉÖ:`, {
          ÂéüÂßãËæìÂÖ•: amount,
          ËΩ¨Êç¢ÂêéÊï∞ÂÄº: trxAmount,
          ËæìÂÖ•Á±ªÂûã: typeof amount,
          ÊòØÂê¶Á°¨È°∂ÊàñÊúÄÂ§ßË¥≠‰π∞Èáè: isHardCapOrMaxBuy
        })

        // ‰øÆÂ§çÔºöÂêàÁêÜÁöÑÊ†ºÂºèÂåñÈòàÂÄºÔºåÈÅøÂÖçÊ≠£Â∏∏Êï∞ÂÄºË¢´ÈîôËØØÊ†ºÂºèÂåñ
        if (isHardCapOrMaxBuy && trxAmount >= 1000000000) { // Á°¨È°∂/ÊúÄÂ§ßË¥≠‰π∞ÈáèÔºö10‰∫ø‰ª•‰∏ä‰ΩøÁî®BÂçï‰Ωç
          return `${(trxAmount / 1000000000).toFixed(2)}B TRX`
        } else if (isHardCapOrMaxBuy && trxAmount >= 1000000) { // Á°¨È°∂/ÊúÄÂ§ßË¥≠‰π∞ÈáèÔºö100‰∏á‰ª•‰∏ä‰ΩøÁî®MÂçï‰Ωç
          return `${(trxAmount / 1000000).toFixed(2)}M TRX`
        } else if (trxAmount >= 10000000) { // ÊôÆÈÄöÊÉÖÂÜµÔºö1ÂçÉ‰∏áTRX‰ª•‰∏äÊâç‰ΩøÁî®MÂçï‰Ωç
          return `${(trxAmount / 1000000).toFixed(2)}M TRX`
        } else if (trxAmount >= 10000) { // 1‰∏áTRX‰ª•‰∏äÊâç‰ΩøÁî®KÂçï‰Ωç
          return `${(trxAmount / 1000).toFixed(2)}K TRX`
        } else {
          // ÂØπ‰∫éÊ≠£Â∏∏ËåÉÂõ¥ÁöÑÊï∞ÂÄºÔºàÂ¶Ç1000 TRXÔºâÔºåÁõ¥Êé•ÊòæÁ§∫
          return `${Math.round(trxAmount).toLocaleString()} TRX`
        }
      } catch (error) {
        console.warn('‚ö†Ô∏è TRXÈáëÈ¢ùÊ†ºÂºèÂåñÂ§±Ë¥•:', error, 'amount:', amount)
        return '0 TRX'
      }
    },

    // ÂÆâÂÖ®ËΩ¨Êç¢ BigInt Âà∞Êï∞Â≠ó
    safeBigIntToNumber(value) {
      if (typeof value === 'bigint') {
        return parseFloat(value.toString())
      }
      return parseFloat(value) || 0
    },

    // Ê†ºÂºèÂåñ‰ª£Â∏ÅÊï∞Èáè - ‰øÆÂ§çÔºöÊ≠£Á°ÆÂ§ÑÁêÜdecimalsÂèÇÊï∞ÂíåBigIntÁ±ªÂûã
    formatTokenAmount(amount, decimals = 18) {
      if (!amount) return '100%'

      try {
        // Ê∑ªÂä†ËØ¶ÁªÜÁöÑË∞ÉËØïÊó•Âøó
        console.log(`üîç formatTokenAmount ËæìÂÖ•ËØ¶ÊÉÖ:`, {
          amount: amount,
          Á±ªÂûã: typeof amount,
          ÊòØÂê¶‰∏∫BigInt: typeof amount === 'bigint',
          Êï∞ÂÄº: amount.toString()
        })

        // Â¶ÇÊûúamountÊòØÂ≠óÁ¨¶‰∏≤‰∏îÂåÖÂê´Â∞èÊï∞ÁÇπÔºåËØ¥ÊòéÂ∑≤ÁªèÊ†ºÂºèÂåñËøá‰∫Ü
        if (typeof amount === 'string' && amount.includes('.')) {
          const num = parseFloat(amount)
          return `${num.toLocaleString()}`
        }

        // Â§ÑÁêÜBigIntÁ±ªÂûã
        let amountToProcess = amount
        if (typeof amount === 'bigint') {
          amountToProcess = amount.toString()
        }

        // ‰ΩøÁî®TokenServiceÁöÑÈùôÊÄÅÊñπÊ≥ïÊ≠£Á°ÆÂ§ÑÁêÜdecimals
        const formattedAmount = TokenService.formatTokenAmount(amountToProcess, decimals)
        console.log(`üîç TokenService.formatTokenAmount ÁªìÊûú:`, {
          ËæìÂÖ•: amountToProcess,
          decimals: decimals,
          ËæìÂá∫: formattedAmount
        })

        const num = parseFloat(formattedAmount)
        console.log(`üîç ÊúÄÁªàÊï∞ÂÄº:`, {
          Ê†ºÂºèÂåñÂêé: formattedAmount,
          Ëß£ÊûêÂêé: num,
          ÊòØÂê¶‰∏∫NaN: isNaN(num)
        })

        if (isNaN(num) || num === 0) {
          console.warn('‚ö†Ô∏è Ëß£ÊûêÂêéÁöÑÊï∞ÂÄºÊó†ÊïàÔºåËøîÂõûÂéüÂßãÂÄº')
          return amountToProcess
        }

        return `${num.toLocaleString()}`
      } catch (error) {
        console.warn('‚ö†Ô∏è ‰ª£Â∏ÅÊï∞ÈáèÊ†ºÂºèÂåñÂ§±Ë¥•:', error, 'amount:', amount, 'decimals:', decimals)
        return '100%'
      }
    },

    // Ê†ºÂºèÂåñÂÖëÊç¢ÊØî‰æã
    formatExchangeRate(amount) {
      if (!amount) return '1 TST=1 TRX'

      try {
        const rate = parseInt(amount) / 1000000 // ËΩ¨Êç¢ SUN Âà∞ TRX
        return `1 TST=${rate} TRX`
      } catch (error) {
        return '1 TST=1 TRX'
      }
    },

    // Ê†ºÂºèÂåñËÉå‰π¶‰ø°ÊÅØ
    formatBackingInfo(backingShare, backingReceiver) {
      if (!backingShare || parseInt(backingShare) === 0) {
        return '25% TRX / 50% union'
      }

      try {
        const percentage = parseInt(backingShare)
        const receiverShort = backingReceiver ?
          `${backingReceiver.slice(0, 6)}...${backingReceiver.slice(-4)}` :
          'union'
        return `${percentage}% TRX / ${100 - percentage}% ${receiverShort}`
      } catch (error) {
        return '25% TRX / 50% union'
      }
    },

    // Ê†ºÂºèÂåñ LP ÂàÜÈÖç
    formatLpDistribution(userShare, devShare) {
      try {
        const userPercent = parseInt(userShare) / 100 || 75
        const devPercent = parseInt(devShare) / 100 || 25
        return `${userPercent}% TRX / ${devPercent}% union`
      } catch (error) {
        return '25% TRX / 50% union'
      }
    },

    // ËÆ°ÁÆóÁªìÊùüÊó∂Èó¥
    calculateEndTime(startTime, duration) {
      if (!startTime || !duration) return '2025/08/15 14:14(4d 2h)'

      try {
        const start = parseInt(startTime)
        const durationSec = parseInt(duration)
        const endTimestamp = start + durationSec
        return this.formatTimestamp(endTimestamp)
      } catch (error) {
        return '2025/08/15 14:14(4d 2h)'
      }
    },

    // ËÆ°ÁÆóÊåÅÁª≠Êó∂Èó¥ÔºàÊåâÂ§©ÊòæÁ§∫Ôºâ- ‰øÆÂ§çÔºöÁÆÄÂåñÈÄªËæëÔºåÊèêÈ´òÂèØÈù†ÊÄß
    calculateDuration(startTime, endTime) {
      if (!startTime) {
        console.log('‚ö†Ô∏è ÂºÄÂßãÊó∂Èó¥‰∏∫Á©∫Ôºå‰ΩøÁî®ÈªòËÆ§ÊåÅÁª≠Êó∂Èó¥')
        return '90 days'
      }

      try {
        let startTimestamp = startTime
        let endTimestamp = endTime

        // Áªü‰∏ÄËΩ¨Êç¢‰∏∫Êó∂Èó¥Êà≥ÔºàÁßíÔºâ
        if (typeof startTime === 'string') {
          startTimestamp = this.parseTimestampFromString(startTime)
        } else if (typeof startTime === 'number') {
          startTimestamp = startTime
        }

        if (typeof endTime === 'string') {
          // ÂÖàÂ∞ùËØï‰ªéÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤‰∏≠ÊèêÂèñÂ§©Êï∞
          const dayMatch = endTime.match(/\((\d+)d/)
          if (dayMatch) {
            const days = parseInt(dayMatch[1])
            console.log(`‚úÖ ‰ªéÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊèêÂèñÊåÅÁª≠Êó∂Èó¥: ${days} days`)
            return `${days} days`
          }
          // Â¶ÇÊûúÊ≤°ÊúâÊâæÂà∞Â§©Êï∞ÔºåÂ∞ùËØïËß£Êûê‰∏∫Êó∂Èó¥Êà≥
          endTimestamp = this.parseTimestampFromString(endTime)
        } else if (typeof endTime === 'number') {
          endTimestamp = endTime
        }

        // Â¶ÇÊûúÊàêÂäüËé∑ÂèñÂà∞‰∏§‰∏™Êó∂Èó¥Êà≥ÔºåËÆ°ÁÆóÂ∑ÆÂÄº
        if (startTimestamp && endTimestamp && typeof startTimestamp === 'number' && typeof endTimestamp === 'number') {
          const diffSeconds = Math.abs(endTimestamp - startTimestamp)
          const days = Math.floor(diffSeconds / (24 * 60 * 60))
          console.log(`‚úÖ ËÆ°ÁÆóÊåÅÁª≠Êó∂Èó¥ÊàêÂäü: ${startTimestamp} -> ${endTimestamp} = ${days} days`)
          return `${days} days`
        }

        console.log('‚ö†Ô∏è Êó†Ê≥ïËÆ°ÁÆóÊåÅÁª≠Êó∂Èó¥ÔºåÂèÇÊï∞Á±ªÂûã‰∏çÂåπÈÖç:', {
          startTime: typeof startTime,
          endTime: typeof endTime,
          startTimestamp,
          endTimestamp
        })
        return '90 days'
      } catch (error) {
        console.error('‚ùå ËÆ°ÁÆóÊåÅÁª≠Êó∂Èó¥Â§±Ë¥•:', error)
        return '90 days'
      }
    },

    // ‰ªéÊ†ºÂºèÂåñÁöÑÊó∂Èó¥Â≠óÁ¨¶‰∏≤‰∏≠Ëß£ÊûêÊó∂Èó¥Êà≥
    parseTimestampFromString(timeString) {
      try {
        // Â∞ùËØï‰ªéÂ≠óÁ¨¶‰∏≤‰∏≠ÊèêÂèñÊó•ÊúüÈÉ®ÂàÜÔºå‰æãÂ¶Ç "2025/08/15 14:14(4d 2h)"
        const dateMatch = timeString.match(/(\d{4})\/(\d{1,2})\/(\d{1,2})\s+(\d{1,2}):(\d{1,2})/)
        if (dateMatch) {
          const [, year, month, day, hour, minute] = dateMatch
          const date = new Date(year, month - 1, day, hour, minute)
          return Math.floor(date.getTime() / 1000)
        }
        return null
      } catch (error) {
        console.error('‚ùå Ëß£ÊûêÊó∂Èó¥Â≠óÁ¨¶‰∏≤Â§±Ë¥•:', error)
        return null
      }
    },

    // ËÆ°ÁÆóËß£ÈîÅËΩÆÊ¨°
    calculateVestingRounds(vestingRate) {
      if (!vestingRate) return '5 rounds'

      try {
        const rate = parseInt(vestingRate.replace('%', ''))
        const rounds = Math.ceil(100 / rate)
        return `${rounds} rounds`
      } catch (error) {
        return '5 rounds'
      }
    }
  }
}
</script>

<style lang="scss" scoped>
.token-detail-page {
  min-height: 100vh;
  background: linear-gradient(180deg, #1a1a2e 0%, #16213e 100%);
  color: #ffffff;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
}

/* Ëá™ÂÆö‰πâÂØºËà™Ê†è */
.custom-header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 1000;
  background: rgba(26, 26, 46, 0.95);
  backdrop-filter: blur(10px);
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);

  .header-content {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 16px;
    height: 56px;

    .header-left {
      display: flex;
      align-items: center;
      gap: 12px;

      .back-btn {
        background: none;
        border: none;
        color: #ffffff;
        padding: 8px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background-color 0.2s;

        &:hover {
          background: rgba(255, 255, 255, 0.1);
        }
      }

      .header-title {
        font-size: 18px;
        font-weight: 600;
        margin: 0;
        color: #ffffff;
      }
    }
  }
}

/* ‰∏ªË¶ÅÂÜÖÂÆπÂå∫Âüü */
.main-content {
  padding-top: 72px;
  padding-bottom: 20px;
  padding-left: 16px;
  padding-right: 16px;
}

/* ËøîÂõûÊåâÈíÆ */
.return-section {
  margin-bottom: 16px;

  .return-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    background: none;
    border: none;
    color: #8b9dc3;
    font-size: 14px;
    padding: 8px 0;
    cursor: pointer;
    transition: color 0.2s;

    &:hover {
      color: #ffffff;
    }
  }
}

/* È°µÈù¢Ê†áÈ¢ò */
.page-title {
  margin-bottom: 20px;

  h2 {
    font-size: 20px;
    font-weight: 600;
    margin: 0;
    color: #ffffff;
  }
}

/* ‰ª£Â∏Å‰ø°ÊÅØÂç°Áâá */
.token-info-card {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;

  .token-header {
    display: flex;
    align-items: flex-start;
    gap: 16px;
    margin-bottom: 16px;

    .token-avatar {
      .token-icon-wrapper {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 32px;
        color: #ffffff;
      }
    }

    .token-details {
      flex: 1;

      .token-name {
        font-size: 24px;
        font-weight: 700;
        margin: 0 0 4px 0;
        color: #ffffff;
      }

      .token-symbol {
        font-size: 16px;
        color: #8b9dc3;
        margin: 0 0 12px 0;
      }

      .contract-address {
        display: flex;
        align-items: center;
        gap: 8px;

        .address-text {
          font-size: 14px;
          color: #8b9dc3;
          font-family: 'Monaco', 'Menlo', monospace;
        }

        .copy-btn,
        .external-btn {
          background: none;
          border: none;
          color: #8b9dc3;
          padding: 4px;
          border-radius: 4px;
          cursor: pointer;
          transition: color 0.2s;

          &:hover {
            color: #ffffff;
          }
        }
      }
    }
  }

  .token-description {
    margin-bottom: 20px;
    padding-bottom: 20px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);

    p {
      font-size: 14px;
      line-height: 1.6;
      color: #8b9dc3;
      margin: 0;
    }
  }

  .social-actions {
    display: flex;
    justify-content: center;
    gap: 12px;

    .social-btn {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      border: none;
      background: rgba(255, 255, 255, 0.1);
      color: #8b9dc3;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s;

      &:hover {
        transform: scale(1.05);
      }

      &:active {
        transform: scale(0.95);
      }
    }

    .twitter-btn:hover {
      background: rgba(29, 161, 242, 0.2);
      color: #1da1f2;
    }

    .telegram-btn:hover {
      background: rgba(0, 136, 204, 0.2);
      color: #0088cc;
    }

    .website-btn:hover {
      background: rgba(59, 130, 246, 0.2);
      color: #3b82f6;
    }
  }
}

/* Êìç‰ΩúÊåâÈíÆÁªÑ */
.action-buttons {
  display: flex;
  gap: 12px;
  margin-bottom: 24px;

  .action-btn {
    flex: 1;
    padding: 12px 16px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    background: rgba(255, 255, 255, 0.05);
    color: #8b9dc3;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;

    &.active {
      background: rgba(59, 130, 246, 0.2);
      border-color: #3b82f6;
      color: #3b82f6;
    }

    &:hover:not(.active) {
      background: rgba(255, 255, 255, 0.1);
      color: #ffffff;
    }
  }
}

/* ÈÄöÁî®Âç°ÁâáÊ†∑Âºè */
.info-section-card {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 16px;

  .section-title {
    font-size: 16px;
    font-weight: 600;
    color: #ffffff;
    margin: 0 0 16px 0;
  }
}

/* ‰ª£Â∏Å‰ø°ÊÅØË°®Ê†º */
.token-info-table,
.lge-info-table {
  .info-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 0;
    border-bottom: 1px solid rgba(255, 255, 255, 0.08);

    &:last-child {
      border-bottom: none;
    }

    .info-label {
      font-size: 14px;
      color: #8b9dc3;
      font-weight: 500;
    }

    .info-value {
      font-size: 14px;
      color: #ffffff;
      font-weight: 600;
      text-align: right;
    }
  }
}

/* ÂÖçË¥£Â£∞Êòé */
.disclaimer-section {
  display: flex;
  align-items: flex-start;
  background: rgba(239, 68, 68, 0.1);
  border: 1px solid rgba(239, 68, 68, 0.2);
  border-radius: 12px;
  padding: 16px;
  margin-top: 20px;

  .disclaimer-icon {
    color: #ef4444;
    margin-right: 12px;
    flex-shrink: 0;
    margin-top: 2px;
  }

  .disclaimer-text {
    flex: 1;

    p {
      color: #ef4444;
      font-size: 13px;
      line-height: 1.5;
      margin: 0;
    }

    strong {
      font-weight: 600;
    }
  }
}

/* === Â¢ûÂº∫ÁöÑÁªëÂÆöÊõ≤Á∫øÊ†∑Âºè === */
.bonding-curve-card {
  background: rgba(255, 255, 255, 0.03);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  backdrop-filter: blur(10px);
}

.bonding-curve-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.curve-title {
  font-size: 18px;
  font-weight: 600;
  color: #ffffff;
  margin: 0;
}

.percentage-badge {
  background: rgba(255, 255, 255, 0.9);
  color: #1a1a1a;
  padding: 8px 16px;
  border-radius: 20px;
  font-size: 16px;
  font-weight: 700;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.enhanced-progress-container {
  margin-bottom: 20px;
}

.progress-track {
  width: 100%;
  height: 8px;
  background: rgba(255, 255, 255, 0.15);
  border-radius: 4px;
  position: relative;
  overflow: hidden;
  margin-bottom: 8px;
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #6366f1 0%, #8b5cf6 50%, #d946ef 100%);
  border-radius: 4px;
  transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
}

.progress-fill::after {
  content: '';
  position: absolute;
  top: 0;
  right: 0;
  width: 20px;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3));
  animation: shimmer 2s infinite;
}

@keyframes shimmer {
  0% { transform: translateX(-20px); opacity: 0; }
  50% { transform: translateX(0); opacity: 1; }
  100% { transform: translateX(20px); opacity: 0; }
}

.progress-thumb {
  position: absolute;
  top: 50%;
  width: 18px;
  height: 18px;
  background: #ffffff;
  border: 3px solid #6366f1;
  border-radius: 50%;
  transform: translate(-50%, -50%);
  transition: left 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4);
}

.progress-labels {
  display: flex;
  justify-content: space-between;
  font-size: 12px;
  color: rgba(255, 255, 255, 0.6);
  font-weight: 500;
}

.curve-status-info {
  text-align: center;
}

.status-text {
  color: rgba(255, 255, 255, 0.8);
  font-size: 14px;
  margin-bottom: 16px;
  line-height: 1.4;
}

.funding-stats {
  display: flex;
  justify-content: space-around;
  gap: 20px;
}

.stat-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
}

.stat-label {
  font-size: 12px;
  color: rgba(255, 255, 255, 0.6);
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.stat-value {
  font-size: 16px;
  color: #ffffff;
  font-weight: 700;
}

/* ËæìÂÖ•Âå∫Âüü */
.input-section {
  margin-bottom: 20px;

  .input-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;

    .input-label {
      font-size: 14px;
      color: #8b9dc3;
    }

    .max-btn {
      background: #3b82f6;
      border: none;
      color: #ffffff;
      padding: 4px 12px;
      border-radius: 8px;
      font-size: 12px;
      cursor: pointer;
      transition: background-color 0.2s;

      &:hover {
        background: #2563eb;
      }
    }
  }

  .amount-input {
    width: 100%;
    padding: 12px 16px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    color: #ffffff;
    font-size: 16px;
    margin-bottom: 8px;

    &::placeholder {
      color: #8b9dc3;
    }

    &:focus {
      outline: none;
      border-color: #3b82f6;
    }
  }

  .balance-info {
    font-size: 1px !important;
    color: #8b9dc3;
  }
}

/* ÊåâÈíÆÊ†∑Âºè */
.enter-presale-btn,
.buy-now-btn {
  width: 100%;
  padding: 16px;
  background: linear-gradient(135deg, #8b5cf6 0%, #3b82f6 100%);
  border: none;
  border-radius: 12px;
  color: #ffffff;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  transition: transform 0.2s;

  &:hover {
    transform: translateY(-2px);
  }

  &:active {
    transform: translateY(0);
  }
}

/* ÂÜÖÁõòÊä¢Ë¥≠ */
.internal-market-title {
  font-size: 16px;
  font-weight: 600;
  color: #ffffff;
  margin-bottom: 8px;
}

.internal-market-desc {
  font-size: 13px;
  color: #8b9dc3;
  line-height: 1.5;
  margin-bottom: 20px;
}

.quantity-selector {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 20px;
  margin-bottom: 16px;

  .quantity-btn {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    border: 1px solid rgba(255, 255, 255, 0.2);
    background: rgba(255, 255, 255, 0.05);
    color: #ffffff;
    font-size: 18px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;

    &:hover {
      background: rgba(255, 255, 255, 0.1);
      border-color: rgba(255, 255, 255, 0.3);
    }

    &:active {
      transform: scale(0.95);
    }
  }

  .quantity-display {
    font-size: 16px;
    font-weight: 600;
    color: #ffffff;
    min-width: 120px;
    text-align: center;
  }
}

.quota-info {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;

  .quota-label {
    font-size: 14px;
    color: #8b9dc3;
  }

  .quota-value {
    font-size: 14px;
    color: #ffffff;
    font-weight: 600;
  }
}

.real-time-price {
  font-size: 12px;
  color: #8b9dc3;
  text-align: center;
  margin-top: 16px;
}

/* Âä†ËΩΩÁä∂ÊÄÅÊ†∑Âºè */
.loading-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(26, 26, 46, 0.9);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  color: #ffffff;
}

.loading-spinner {
  width: 40px;
  height: 40px;
  border: 4px solid rgba(255, 255, 255, 0.3);
  border-top: 4px solid #3b82f6;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-bottom: 16px;
}

@keyframes spin {
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
}

/* Âú®ËøôÈáåÊ∑ªÂä†Êñ∞ÁöÑÊ†∑Âºè */
.info-section-card .balance-info {
  font-size: 14px !important;
  color: #8b9dc3;
}

/* È¢ÑÂîÆÂÜÖÂÆπÊ†∑Âºè */
.presale-content {
  animation: fadeIn 0.3s ease-in;
}

.buy-sell-section {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.buy-sell-tabs {
  display: flex;
  gap: 8px;
  margin-bottom: 20px;

  .tab-btn {
    flex: 1;
    padding: 12px 16px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    background: rgba(255, 255, 255, 0.05);
    color: #8b9dc3;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;

    &.active {
      background: #3b82f6;
      border-color: #3b82f6;
      color: #ffffff;
    }

    &:hover:not(.active) {
      background: rgba(255, 255, 255, 0.1);
      color: #ffffff;
    }
  }
}

.action-button {
  width: 100%;
  padding: 16px;
  background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
  border: none;
  border-radius: 12px;
  color: #ffffff;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  transition: transform 0.2s;

  &:hover {
    transform: translateY(-2px);
  }

  &:active {
    transform: translateY(0);
  }
}

/* LPËØ¶ÊÉÖÂå∫Âüü */
.lp-details-section {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  padding: 20px;
}

.lp-item {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  padding: 12px 0;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);

  &:last-child {
    border-bottom: none;
  }

  .lp-label {
    font-size: 14px;
    color: #8b9dc3;
    flex: 1;
  }

  .lp-value {
    font-size: 14px;
    color: #ffffff;
    font-weight: 600;
    text-align: right;
    flex: 1;
  }

  .lp-sub-info {
    font-size: 12px;
    color: #8b9dc3;
    margin-top: 4px;
    text-align: right;
    flex: 1;
  }
}

.receive-button {
  width: 100%;
  padding: 16px;
  background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
  border: none;
  border-radius: 12px;
  color: #ffffff;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  margin-top: 16px;
  transition: transform 0.2s;

  &:hover {
    transform: translateY(-2px);
  }

  &:active {
    transform: translateY(0);
  }
}

/* Âä®ÁîªÊïàÊûú */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* ÂìçÂ∫îÂºèËÆæËÆ° */
@media (max-width: 375px) {
  .main-content {
    padding-left: 12px;
    padding-right: 12px;
  }

  .info-section-card {
    padding: 16px;
    margin-bottom: 12px;
  }

  .token-info-card {
    padding: 16px;

    .token-header {
      gap: 12px;

      .token-avatar .token-icon-wrapper {
        width: 50px;
        height: 50px;
        font-size: 28px;
      }

      .token-details {
        .token-name {
          font-size: 20px;
        }

        .token-symbol {
          font-size: 14px;
        }
      }
    }
  }

  /* ÁªëÂÆöÊõ≤Á∫øÂìçÂ∫îÂºèË∞ÉÊï¥ */
  .bonding-curve-card {
    padding: 16px;
  }

  .bonding-curve-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 12px;
    margin-bottom: 16px;
  }

  .curve-title {
    font-size: 16px;
  }

  .percentage-badge {
    padding: 6px 12px;
    font-size: 14px;
    align-self: flex-end;
  }

  .funding-stats {
    gap: 16px;
  }

  .stat-value {
    font-size: 14px;
  }

  .action-buttons {
    gap: 8px;

    .action-btn {
      padding: 10px 12px;
      font-size: 13px;
    }
  }

  .percentage-display {
    font-size: 20px;
    padding: 10px 16px;
  }
}

/* === È¢ÑÂîÆÂèÇ‰∏éÂå∫ÂüüÊ†∑Âºè === */
.presale-participation-section {
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  padding-top: 20px;
  margin-top: 20px;
}

.presale-section-title {
  color: #ffffff;
  font-size: 18px;
  font-weight: 600;
  margin-bottom: 16px;
  text-align: center;
}

.presale-input-container {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.amount-input-wrapper {
  position: relative;
  display: flex;
  align-items: center;
}

.presale-amount-input {
  flex: 1;
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 8px;
  padding: 14px 80px 14px 16px;
  color: #ffffff;
  font-size: 16px;
  outline: none;
  transition: all 0.2s ease;
}

.presale-amount-input:focus {
  border-color: #00d4ff;
  box-shadow: 0 0 0 2px rgba(0, 212, 255, 0.2);
  background: rgba(255, 255, 255, 0.08);
}

.presale-amount-input:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.presale-amount-input::placeholder {
  color: rgba(255, 255, 255, 0.5);
}

.max-button {
  position: absolute;
  right: 8px;
  background: #00d4ff;
  color: #ffffff;
  border: none;
  border-radius: 6px;
  padding: 8px 16px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  z-index: 2;
}

.max-button:hover:not(:disabled) {
  background: #00b8e6;
  transform: scale(1.05);
}

.max-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.balance-display {
  color: rgba(255, 255, 255, 0.7);
  font-size: 14px;
  text-align: left;
  padding-left: 4px;
}

.validation-error {
  color: #ff6b6b;
  font-size: 13px;
  padding-left: 4px;
  margin-top: -4px;
}

.enter-presale-button {
  background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #d946ef 100%);
  color: #ffffff;
  border: none;
  border-radius: 12px;
  padding: 16px 24px;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
  position: relative;
  overflow: hidden;
  min-height: 52px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.enter-presale-button:hover:not(:disabled) {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(99, 102, 241, 0.4);
}

.enter-presale-button:active:not(:disabled) {
  transform: translateY(0);
}

.enter-presale-button:disabled {
  opacity: 0.6;
  cursor: not-allowed;
  transform: none;
  box-shadow: 0 2px 8px rgba(99, 102, 241, 0.2);
}

.enter-presale-button.loading {
  background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
  cursor: not-allowed;
}

.enter-presale-button.success {
  background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
  animation: successPulse 0.6s ease-out;
}

@keyframes successPulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
}

.loading-spinner {
  width: 20px;
  height: 20px;
  border: 2px solid rgba(255, 255, 255, 0.3);
  border-top: 2px solid #ffffff;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* Â§ßÂ±èÂπïÈÄÇÈÖç */
@media (min-width: 768px) {
  .token-detail-page {
    max-width: 480px;
    margin: 0 auto;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
  }
}

/* ÂìçÂ∫îÂºèË∞ÉÊï¥ */
@media (max-width: 375px) {
  .presale-participation-section {
    padding-top: 16px;
    margin-top: 16px;
  }

  .presale-section-title {
    font-size: 16px;
    margin-bottom: 12px;
  }

  .presale-amount-input {
    padding: 12px 70px 12px 14px;
    font-size: 15px;
  }

  .max-button {
    padding: 6px 12px;
    font-size: 13px;
  }

  .enter-presale-button {
    padding: 14px 20px;
    font-size: 15px;
    min-height: 48px;
  }
}

/* === ‰ª£Â∏ÅÂØºËà™Êéß‰ª∂Ê†∑Âºè === */
.token-navigation {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-left: auto;
}

.nav-btn {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 6px;
  padding: 8px;
  color: #ffffff;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 32px;
  height: 32px;
}

.nav-btn:hover:not(:disabled) {
  background: rgba(255, 255, 255, 0.2);
  border-color: rgba(255, 255, 255, 0.3);
  transform: scale(1.05);
}

.nav-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.token-index-display {
  color: #ffffff;
  font-size: 14px;
  font-weight: 500;
  min-width: 60px;
  text-align: center;
  background: rgba(255, 255, 255, 0.1);
  padding: 6px 12px;
  border-radius: 6px;
  border: 1px solid rgba(255, 255, 255, 0.2);
}

/* ÂìçÂ∫îÂºèË∞ÉÊï¥ */
@media (max-width: 480px) {
  .token-navigation {
    gap: 8px;
  }

  .nav-btn {
    padding: 6px;
    min-width: 28px;
    height: 28px;
  }

  .token-index-display {
    font-size: 12px;
    padding: 4px 8px;
    min-width: 50px;
  }
}
</style>